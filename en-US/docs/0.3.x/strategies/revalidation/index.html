<!DOCTYPE html>
<html lang="en" class="light">
    <head>
<base href="https://arctic-hen7.github.io/perseus/" />
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href=".perseus/static/tailwind.css" />
        <link rel="stylesheet" href=".perseus/static/styles/style.css" />
    <script>window.__PERSEUS_RENDER_CFG = '{"docs/0.1.x/tutorials/first_app/app":"docs","docs/next/tutorials/second-app":"docs","docs/0.1.x/building":"docs","docs/0.2.x/views":"docs","docs/next/reference/error-pages":"docs","docs/deploying/size":"docs","docs/0.3.x/templates/setting-headers":"docs","docs/0.3.x/server-communication":"docs","docs/0.3.x/plugins/writing":"docs","docs/plugins/functional":"docs","docs/server-communication":"docs","docs/advanced/subsequent-loads":"docs","docs/advanced/intro":"docs","docs/next/reference/strategies/build-state":"docs","docs/next/what-is-perseus":"docs","docs/next/advanced/initial-loads":"docs","docs/next/reference/state/global":"docs","docs/0.2.x/advanced/routing":"docs","docs/strategies/amalgamation":"docs","docs/0.2.x/i18n/defining":"docs","docs/next/reference/templates/setting-headers":"docs","docs/0.1.x/routing":"docs","docs/0.2.x/deploying/intro":"docs","docs/next/reference/ejecting":"docs","docs/next/reference/plugins/using":"docs","docs/plugins/control":"docs","docs/0.3.x/what-is-perseus":"docs","docs/next/reference/plugins/security":"docs","docs/next/reference/plugins/control":"docs","docs/0.2.x/advanced/initial-loads":"docs","docs/next/reference/strategies/amalgamation":"docs","docs/deploying/intro":"docs","docs/0.1.x/error_pages":"docs","docs/pitfalls-and-bugs":"docs","docs/next/reference/deploying/serverless":"docs","docs/0.1.x/serving":"docs","docs/advanced/define_app":"docs","docs/0.3.x/i18n/translations-managers":"docs","docs/0.3.x/i18n/using":"docs","docs/0.3.x/error-pages":"docs","docs/0.3.x/deploying/serverful":"docs","docs/next/reference/snooping":"docs","docs/second-app":"docs","docs/next/advanced/arch":"docs","plugins":"plugins","docs/next/reference/hydration":"docs","docs/0.3.x/plugins/control":"docs","docs/0.3.x/advanced/define_app":"docs","docs/next/reference/deploying/serverful":"docs","docs/next/reference/styling":"docs","docs/0.2.x/what-is-perseus":"docs","docs/0.2.x/i18n/intro":"docs","docs/0.2.x/static-content":"docs","docs/next/reference/testing/checkpoints":"docs","docs/next/reference/deploying/size":"docs","docs/0.3.x/static-content":"docs","docs/stores":"docs","docs/0.2.x/strategies/build-paths":"docs","docs/next/reference/i18n/defining":"docs","docs/0.1.x/strategies/request_state":"docs","docs/next/reference/deploying/docker":"docs","docs/next/reference/plugins/writing":"docs","docs/0.3.x/views":"docs","docs/intro":"docs","docs/0.1.x/tutorials/first_app/intro":"docs","docs/0.3.x/i18n/other-engines":"docs","docs/0.3.x/styling":"docs","docs/plugins/security":"docs","docs/next/reference/plugins/functional":"docs","docs/0.1.x/strategies/build_state":"docs","docs/next/reference/plugins/publishing":"docs","docs/0.2.x/strategies/build-state":"docs","docs/0.3.x/hello-world":"docs","docs/next/reference/deploying/relative-paths":"docs","docs/0.3.x/strategies/build-paths":"docs","docs/0.3.x/testing/checkpoints":"docs","docs/next/reference/strategies/build-paths":"docs","docs/deploying/serverless":"docs","docs/styling":"docs","docs/0.3.x/i18n/defining":"docs","docs/0.2.x/strategies/amalgamation":"docs","docs/next/reference/strategies/revalidation":"docs","docs/0.2.x/debugging":"docs","docs/0.3.x/templates/intro":"docs","docs/0.1.x/intro":"docs","docs/views":"docs","docs/0.3.x/debugging":"docs","comparisons":"comparisons","docs/0.1.x/strategies/build_paths":"docs","docs/0.2.x/advanced/intro":"docs","docs/next/reference/views":"docs","docs/next/advanced/intro":"docs","docs/0.1.x/arch":"docs","docs/testing/manual":"docs","docs/0.3.x/advanced/subsequent-loads":"docs","docs/0.1.x/setup":"docs","docs/next/reference/cli":"docs","docs/next/reference/plugins/tinker":"docs","docs/next/reference/exporting":"docs","docs/next/reference/deploying/intro":"docs","docs/debugging":"docs","docs/0.1.x/tutorials/first_app/setup":"docs","docs/0.2.x/ejecting":"docs","docs/0.2.x/strategies/intro":"docs","docs/0.2.x/testing/intro":"docs","docs/next/reference/static-content":"docs","docs/strategies/intro":"docs","docs/plugins/writing":"docs","docs/next/tutorials/hello-world":"docs","docs/0.2.x/templates/intro":"docs","docs/next/reference/testing/manual":"docs","docs/0.3.x/templates/metadata-modification":"docs","docs/0.2.x/strategies/incremental":"docs","docs/0.2.x/templates/setting-headers":"docs","docs/0.2.x/config-managers":"docs","docs/0.3.x/ejecting":"docs","docs/deploying/serverful":"docs","docs/0.3.x/deploying/relative-paths":"docs","docs/testing/fantoccini-basics":"docs","docs/0.2.x/define-app":"docs","docs/0.2.x/strategies/request-state":"docs","docs/0.1.x/strategies/revalidation":"docs","docs/0.3.x/strategies/revalidation":"docs","docs/next/advanced/routing":"docs","docs/0.1.x/strategies/intro":"docs","docs/next/reference/state/rx":"docs","docs/next/reference/testing/intro":"docs","docs/error-pages":"docs","docs/0.2.x/strategies/revalidation":"docs","docs/0.3.x/strategies/build-state":"docs","docs/0.2.x/second-app":"docs","docs/strategies/build-state":"docs","docs/0.2.x/testing/manual":"docs","docs/0.3.x/advanced/routing":"docs","docs/templates/metadata-modification":"docs","docs/static-content":"docs","docs/strategies/incremental":"docs","docs/0.3.x/strategies/request-state":"docs","docs/0.2.x/styling":"docs","docs/testing/checkpoints":"docs","docs/0.1.x/templates":"docs","docs/0.2.x/testing/fantoccini-basics":"docs","docs/next/reference/templates/intro":"docs","docs/0.1.x/config_managers":"docs","docs/0.1.x/strategies/incremental":"docs","docs/i18n/intro":"docs","docs/0.3.x/plugins/using":"docs","docs/0.2.x/templates/metadata-modification":"docs","docs/0.3.x/testing/intro":"docs","docs/0.3.x/snooping":"docs","docs/what-is-perseus":"docs","docs/templates/setting-headers":"docs","docs/next/advanced/subsequent-loads":"docs","docs/0.3.x/strategies/amalgamation":"docs","docs/0.2.x/testing/checkpoints":"docs","docs/i18n/translations-managers":"docs","docs/updating":"docs","docs/0.2.x/i18n/translations-managers":"docs","docs/next/reference/strategies/intro":"docs","docs/0.1.x/integrations/actix-web":"docs","docs/next/intro":"docs","docs/0.2.x/error-pages":"docs","docs/next/reference/templates/router-state":"docs","docs/0.2.x/intro":"docs","docs/next/advanced/define_app":"docs","docs/0.3.x/advanced/initial-loads":"docs","docs/0.3.x/deploying/intro":"docs","docs/next/reference/state/freezing":"docs","docs/0.3.x/plugins/functional":"docs","docs/0.1.x/tutorials/first_app/template":"docs","docs/0.3.x/plugins/security":"docs","docs/0.3.x/strategies/incremental":"docs","docs/strategies/request-state":"docs","docs/testing/intro":"docs","docs/next/reference/strategies/request-state":"docs","docs/0.3.x/i18n/intro":"docs","docs/next/reference/plugins/intro":"docs","docs/i18n/using":"docs","docs/ejecting":"docs","docs/0.3.x/testing/fantoccini-basics":"docs","docs/next/reference/define-app":"docs","docs/next/reference/debugging":"docs","docs/next/reference/updating":"docs","docs/next/core-principles":"docs","docs/advanced/arch":"docs","docs/plugins/tinker":"docs","docs/0.3.x/define-app":"docs","docs/0.3.x/updating":"docs","docs/next/reference/i18n/translations-managers":"docs","docs/0.2.x/cli":"docs","docs/0.2.x/deploying/exporting":"docs","docs/define-app":"docs","docs/next/reference/server-communication":"docs","docs/0.3.x/second-app":"docs","docs/0.1.x/cli":"docs","docs/next/reference/templates/metadata-modification":"docs","docs/advanced/routing":"docs","docs/strategies/revalidation":"docs","docs/i18n/defining":"docs","docs/next/reference/i18n/other-engines":"docs","docs/next/reference/stores":"docs","docs/0.3.x/plugins/publishing":"docs","docs/next/reference/testing/fantoccini-basics":"docs","docs/cli":"docs","docs/advanced/initial-loads":"docs","docs/0.3.x/stores":"docs","docs/hydration":"docs","docs/strategies/build-paths":"docs","docs/snooping":"docs","docs/0.3.x/exporting":"docs","docs/0.3.x/deploying/serverless":"docs","docs/0.3.x/deploying/size":"docs","docs/0.3.x/hydration":"docs","docs/0.3.x/testing/manual":"docs","docs/0.3.x/strategies/intro":"docs","docs/0.2.x/hello-world":"docs","docs/next/reference/i18n/using":"docs","docs/hello-world":"docs","docs/next/reference/i18n/intro":"docs","docs/plugins/using":"docs","docs/0.3.x/plugins/tinker":"docs","docs/0.3.x/intro":"docs","docs/0.2.x/i18n/other-engines":"docs","docs":"docs","docs/0.2.x/i18n/using":"docs","docs/exporting":"docs","docs/0.2.x/advanced/subsequent-loads":"docs","docs/next/reference/state/idb-freezing":"docs","docs/0.3.x/pitfalls-and-bugs":"docs","docs/templates/intro":"docs","docs/0.2.x/updating":"docs","index":"index","docs/0.3.x/deploying/docker":"docs","docs/0.2.x/advanced/arch":"docs","docs/next/reference/strategies/incremental":"docs","docs/plugins/intro":"docs","docs/deploying/relative-paths":"docs","docs/next/reference/pitfalls-and-bugs":"docs","docs/0.3.x/plugins/intro":"docs","docs/0.3.x/cli":"docs","docs/0.3.x/advanced/arch":"docs","docs/deploying/docker":"docs","docs/0.3.x/advanced/intro":"docs","docs/plugins/publishing":"docs","docs/i18n/other-engines":"docs"}';</script>
<script type="module">
    import init, { run } from "https://arctic-hen7.github.io/perseus/.perseus/bundle.js";
    async function main() {
        await init("https://arctic-hen7.github.io/perseus/.perseus/bundle.wasm");
        run();
    }
    main();
</script>
<!--PERSEUS_INTERPOLATED_HEAD_BEGINS--><title data-hk="1.0">Revalidation | Perseus Docs</title><link data-hk="1.1" rel="stylesheet" href=".perseus/static/styles/markdown.css"/><link href=".perseus/static/styles/docs_links_markdown.css" data-hk="1.2" rel="stylesheet"/><link rel="stylesheet" data-hk="1.3" href=".perseus/static/prism.css"/>
<script>window.__PERSEUS_INITIAL_STATE = `{"title":"Revalidation","content":"<h1>Revalidation</h1>\\n<p>While the <em>build state</em> and <em>build paths</em> strategies are excellent for generating pages efficiently, they can't be updated for new content. For example, using these strategies alone, you'd need to rebuild a blog every time you added a new post, even if those posts were stored in a database. With <em>revalidation</em>, you can avoid this by instructing Perseus to rebuild a template if certain criteria are met when it's requested.</p>\\n<p>There are two types of revalidation: time-based and logic-based. The former lets you re-render a template every 24 hours or the like, while the latter allows you to re-render a template if an arbitrary function returns <code>true</code>.</p>\\n<h2>Time-Based Revalidation Usage</h2>\\n<p>Here's an example of time-based revalidation from <a href=\\"https://github.com/arctic-hen7/perseus/blob/main/examples/showcase/src/templates/time.rs\\">here</a> (note that this uses <em>incremental generation</em> as well):</p>\\n<pre><code class=\\"language-rust\\">use perseus::{\\n    ErrorCause, GenericErrorWithCause, RenderFnResult, RenderFnResultWithCause, Template,\\n};\\nuse serde::{Deserialize, Serialize};\\nuse sycamore::prelude::{component, view, Html, View};\\n\\n#[derive(Serialize, Deserialize, Debug)]\\npub struct TimePageProps {\\n    pub time: String,\\n}\\n\\n#[perseus::template(TimePage)]\\n#[component(TimePage&lt;G&gt;)]\\npub fn time_page(props: TimePageProps) -&gt; View&lt;G&gt; {\\n    view! {\\n        p { (format!(&quot;The time when this page was last rendered was '{}'.&quot;, props.time)) }\\n    }\\n}\\n\\npub fn get_template&lt;G: Html&gt;() -&gt; Template&lt;G&gt; {\\n    Template::new(&quot;timeisr&quot;)\\n        .template(time_page)\\n        // This page will revalidate every five seconds (to illustrate revalidation)\\n        .revalidate_after(&quot;5s&quot;.to_string())\\n        .incremental_generation()\\n        .build_state_fn(get_build_state)\\n        .build_paths_fn(get_build_paths)\\n}\\n\\n#[perseus::autoserde(build_state)]\\npub async fn get_build_state(\\n    path: String,\\n    _locale: String,\\n) -&gt; RenderFnResultWithCause&lt;TimePageProps&gt; {\\n    // This path is illegal, and can't be rendered\\n    if path == &quot;timeisr/tests&quot; {\\n        return Err(GenericErrorWithCause {\\n            error: &quot;illegal page&quot;.into(),\\n            cause: ErrorCause::Client(Some(404)),\\n        });\\n    }\\n    Ok(TimePageProps {\\n        time: format!(&quot;{:?}&quot;, std::time::SystemTime::now()),\\n    })\\n}\\n\\npub async fn get_build_paths() -&gt; RenderFnResult&lt;Vec&lt;String&gt;&gt; {\\n    Ok(vec![&quot;test&quot;.to_string()])\\n}\\n\\n</code></pre>\\n<p>This page displays the time at which it was built (fetched with <em>build state</em>), but rebuilds every five seconds. Note that this doesn't translate to the server's actually rebuilding it every five seconds, but rather the server will rebuild it at the next request if more than five seconds have passed since it was last built (meaning templates on the same build schedule will likely go our of sync quickly).</p>\\n<h3>Time Syntax</h3>\\n<p>Perseus uses a very simple syntax inspired by <a href=\\"\\">this JavaScript project</a> to specify time intervals in the form <code>xXyYzZ</code> (e.g. <code>1w</code>, <code>5s</code>, <code>1w5s</code>), where the lower-case letters are number and the upper-case letters are intervals, the supported of which are listed below:</p>\\n<ul>\\n<li><code>s</code>: second,</li>\\n<li><code>m</code>: minute,</li>\\n<li><code>h</code>: hour,</li>\\n<li><code>d</code>: day,</li>\\n<li><code>w</code>: week,</li>\\n<li><code>M</code>: month (30 days used here, 12M ≠ 1y!),</li>\\n<li><code>y</code>: year (365 days always, leap years ignored, if you want them add them as days)</li>\\n</ul>\\n<h2>Logic-Based Revalidation Usage</h2>\\n<p>Here's an example of logic-based revalidation from <a href=\\"https://github.com/arctic-hen7/perseus/blob/main/examples/showcase/src/templates/time_root.rs\\">here</a> (actually, this example uses both types of revalidation):</p>\\n<pre><code class=\\"language-rust\\">use perseus::{RenderFnResultWithCause, Template};\\nuse serde::{Deserialize, Serialize};\\nuse sycamore::prelude::{component, view, Html, View};\\n\\n#[derive(Serialize, Deserialize, Debug)]\\npub struct TimePageProps {\\n    pub time: String,\\n}\\n\\n#[perseus::template(TimePage)]\\n#[component(TimePage&lt;G&gt;)]\\npub fn time_page(props: TimePageProps) -&gt; View&lt;G&gt; {\\n    view! {\\n        p { (format!(&quot;The time when this page was last rendered was '{}'.&quot;, props.time)) }\\n    }\\n}\\n\\npub fn get_template&lt;G: Html&gt;() -&gt; Template&lt;G&gt; {\\n    Template::new(&quot;time&quot;)\\n        .template(time_page)\\n        // This page will revalidate every five seconds (to illustrate revalidation)\\n        // Try changing this to a week, even though the below custom logic says to always revalidate, we'll only do it weekly\\n        .revalidate_after(&quot;5s&quot;.to_string())\\n        .should_revalidate_fn(|| async { Ok(true) })\\n        .build_state_fn(get_build_state)\\n}\\n\\n#[perseus::autoserde(build_state)]\\npub async fn get_build_state(\\n    _path: String,\\n    _locale: String,\\n) -&gt; RenderFnResultWithCause&lt;TimePageProps&gt; {\\n    Ok(TimePageProps {\\n        time: format!(&quot;{:?}&quot;, std::time::SystemTime::now()),\\n    })\\n}\\n\\n</code></pre>\\n<p>If it were just <code>.should_revalidate_fn()</code> being called here, this page would always be rebuilt every time it's requested (the closure always returns <code>true</code>, note that errors would be <code>String</code>s), however, the additional usage of time-based revalidation regulates this, and the page will only be rebuilt every five seconds. In short, your arbitrary revalidation logic will only be executed at the intervals of your time-based revalidation intervals (if none are set, it will run on every request).</p>\\n<p>Note that you should avoid lengthy operations in revalidation if at all possible, as, like the <em>request state</em> strategy, this logic will be executed while the client is waiting for their page to load.</p>\\n","sidebar_content":"<h1>Introduction</h1>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/intro\\">Introduction</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/what-is-perseus\\">What is Perseus?</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/hello-world\\">Hello World!</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/second-app\\">Your Second App</a></li>\\n</ul>\\n<hr />\\n<h1>Reference</h1>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/define-app\\"><code>define_app!</code></a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/views\\">Writing Views</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/debugging\\">Debugging</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/templates/intro\\">Templates and Routing</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/templates/metadata-modification\\">Modifying the <code>&lt;head&gt;</code></a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/templates/setting-headers\\">Modifying HTTP Headers</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/error-pages\\">Error Pages</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/static-content\\">Static Content</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/i18n/intro\\">Internationalization</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/i18n/defining\\">Defining Translations</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/i18n/using\\">Using Translations</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/i18n/translations-managers\\">Translations Managers</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/i18n/other-engines\\">Other Translation Engines</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/intro\\">Rendering Strategies</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/build-state\\">Build State</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/build-paths\\">Build Paths</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/request-state\\">Request State</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/revalidation\\">Revalidation</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/incremental\\">Incremental Generation</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/amalgamation\\">State Amalgamation</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/hydration\\">Hydration</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/cli\\">CLI</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/ejecting\\">Ejecting</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/snooping\\">Snooping</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/testing/intro\\">Testing</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/testing/checkpoints\\">Checkpoints</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/testing/fantoccini-basics\\">Fantoccini Basics</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/testing/manual\\">Manual Testing</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/styling\\">Styling</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/server-communication\\">Communicating with a Server</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/stores\\">Stores</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/exporting\\">Static Exporting</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/intro\\">Plugins</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/functional\\">Functional Actions</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/control\\">Control Actions</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/using\\">Using Plugins</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/tinker\\">The <code>tinker</code> Action</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/writing\\">Writing Plugins</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/security\\">Security Considerations</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/publishing\\">Publishing Plugins</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/intro\\">Deploying</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/serverful\\">Server Deployment</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/serverless\\">Serverless Deployment</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/size\\">Optimizing Code Size</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/relative-paths\\">Relative Paths</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/docker\\">Docker Deployment</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/updating\\">Migrating from v0.2.x</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/pitfalls-and-bugs\\">Common Pitfalls and Known Bugs</a></li>\\n</ul>\\n<hr />\\n<h1>Advanced</h1>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/intro\\">Under the Hood</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/arch\\">Architecture</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/initial-loads\\">Initial Loads</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/subsequent-loads\\">Subsequent Loads</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/routing\\">Routing</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/define_app\\"><code>define_app</code> in Detail</a></li>\\n</ul>\\n","status":"Stable","manifest":{"stable":"0.3.x","outdated":["0.2.x","0.1.x"],"beta":[],"history_map":{"0.2.x":"v0.2.3","0.1.x":"v0.1.4","0.3.x":"HEAD"}},"current_version":"0.3.x"}`;</script>
</head>
    <body class="bg-white dark:bg-navy">
        <div id="root"><div id="__perseus_content_initial" class="__perseus_content"><header data-hk="3.0" class="shadow-md sm:p-2 w-full bg-white dark:text-white dark:bg-navy mb-20"><div data-hk="3.1" class="flex justify-between"><a data-hk="3.2" class="justify-self-start self-center m-3 ml-5 text-md sm:text-2xl" href="en-US/">Perseus</a><div class="md:hidden m-3 mr-5 tham tham-e-spin tham-w-6 " data-hk="3.3"><div data-hk="3.4" class="tham-box"><div data-hk="3.5" class="dark:bg-white tham-inner"></div></div></div><nav data-hk="3.6" class="hidden md:flex"><ul class="mr-5 flex" data-hk="3.7"><li data-hk="4.0" class="m-3 p-1"><a href="en-US/docs" class="px-2" data-hk="4.1">Docs</a></li><li data-hk="4.2" class="m-3 p-1"><a class="px-2" href="en-US/comparisons" data-hk="4.3">Comparisons</a></li><li class="m-3 p-1" data-hk="4.4"><a class="px-2" data-hk="4.5" href="en-US/plugins">Plugins</a></li></ul></nav></div><nav class="md:hidden w-full text-center justify-center overflow-y-scroll hidden" data-hk="3.8" id="mobile_nav_menu"><div class="mr-5 overflow-y-scroll" data-hk="3.9" style="max-height: 500px"><ul data-hk="3.10"><li data-hk="5.0" class="m-3 p-1"><a data-hk="5.1" href="en-US/docs" class="px-2">Docs</a></li><li class="m-3 p-1" data-hk="5.2"><a href="en-US/comparisons" data-hk="5.3" class="px-2">Comparisons</a></li><li class="m-3 p-1" data-hk="5.4"><a data-hk="5.5" href="en-US/plugins" class="px-2">Plugins</a></li></ul><hr data-hk="3.11"/><div data-hk="3.12" class="text-left p-3"><!--#--><!----><select class="p-2 rounded-md text-white bg-indigo-500" data-hk="6.0"><option data-hk="6.1" value="next">Next (unreleased)</option><!--#--><!--/--><option selected="" value="0.3.x" data-hk="6.2">v⁨0.3.x⁩ (stable)</option><!--#--><option data-hk="6.3" value="0.2.x">v⁨0.2.x⁩ (outdated)</option><option value="0.1.x" data-hk="6.4">v⁨0.1.x⁩ (outdated)</option><!--/--></select><!--/--><div data-hk="3.13" class="docs-links-markdown"><h1>Introduction</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/intro">Introduction</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/what-is-perseus">What is Perseus?</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/hello-world">Hello World!</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/second-app">Your Second App</a></li>
</ul>
<hr />
<h1>Reference</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/define-app"><code>define_app!</code></a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/views">Writing Views</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/debugging">Debugging</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/templates/intro">Templates and Routing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/templates/metadata-modification">Modifying the <code>&lt;head&gt;</code></a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/templates/setting-headers">Modifying HTTP Headers</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/error-pages">Error Pages</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/static-content">Static Content</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/i18n/intro">Internationalization</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/i18n/defining">Defining Translations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/i18n/using">Using Translations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/i18n/translations-managers">Translations Managers</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/i18n/other-engines">Other Translation Engines</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/intro">Rendering Strategies</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/build-state">Build State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/build-paths">Build Paths</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/request-state">Request State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/revalidation">Revalidation</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/incremental">Incremental Generation</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/amalgamation">State Amalgamation</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/hydration">Hydration</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/cli">CLI</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/ejecting">Ejecting</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/snooping">Snooping</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/testing/intro">Testing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/testing/checkpoints">Checkpoints</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/testing/fantoccini-basics">Fantoccini Basics</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/testing/manual">Manual Testing</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/styling">Styling</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/server-communication">Communicating with a Server</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/stores">Stores</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/exporting">Static Exporting</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/intro">Plugins</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/functional">Functional Actions</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/control">Control Actions</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/using">Using Plugins</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/tinker">The <code>tinker</code> Action</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/writing">Writing Plugins</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/security">Security Considerations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/publishing">Publishing Plugins</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/intro">Deploying</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/serverful">Server Deployment</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/serverless">Serverless Deployment</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/size">Optimizing Code Size</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/relative-paths">Relative Paths</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/docker">Docker Deployment</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/updating">Migrating from v0.2.x</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/pitfalls-and-bugs">Common Pitfalls and Known Bugs</a></li>
</ul>
<hr />
<h1>Advanced</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/intro">Under the Hood</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/arch">Architecture</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/initial-loads">Initial Loads</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/subsequent-loads">Subsequent Loads</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/routing">Routing</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/define_app"><code>define_app</code> in Detail</a></li>
</ul>
</div></div></div></nav></header><div data-hk="3.14" class="mt-14 xs:mt-16 sm:mt-20 lg:mt-25 overflow-y-auto flex"><div class="flex w-full" data-hk="3.15"><div class="h-full hidden md:block max-w-xs w-full border-r" data-hk="3.16"><div data-hk="3.17" class="mr-5"><div data-hk="3.18" class="text-left text-black dark:text-white p-3"><aside data-hk="3.19"><!--#--><!----><select data-hk="7.0" class="p-2 rounded-md text-white bg-indigo-500"><option value="next" data-hk="7.1">Next (unreleased)</option><!--#--><!--/--><option value="0.3.x" data-hk="7.2" selected="">v⁨0.3.x⁩ (stable)</option><!--#--><option data-hk="7.3" value="0.2.x">v⁨0.2.x⁩ (outdated)</option><option data-hk="7.4" value="0.1.x">v⁨0.1.x⁩ (outdated)</option><!--/--></select><!--/--><div class="docs-links-markdown" data-hk="3.20"><h1>Introduction</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/intro">Introduction</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/what-is-perseus">What is Perseus?</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/hello-world">Hello World!</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/second-app">Your Second App</a></li>
</ul>
<hr />
<h1>Reference</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/define-app"><code>define_app!</code></a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/views">Writing Views</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/debugging">Debugging</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/templates/intro">Templates and Routing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/templates/metadata-modification">Modifying the <code>&lt;head&gt;</code></a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/templates/setting-headers">Modifying HTTP Headers</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/error-pages">Error Pages</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/static-content">Static Content</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/i18n/intro">Internationalization</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/i18n/defining">Defining Translations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/i18n/using">Using Translations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/i18n/translations-managers">Translations Managers</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/i18n/other-engines">Other Translation Engines</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/intro">Rendering Strategies</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/build-state">Build State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/build-paths">Build Paths</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/request-state">Request State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/revalidation">Revalidation</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/incremental">Incremental Generation</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/strategies/amalgamation">State Amalgamation</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/hydration">Hydration</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/cli">CLI</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/ejecting">Ejecting</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/snooping">Snooping</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/testing/intro">Testing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/testing/checkpoints">Checkpoints</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/testing/fantoccini-basics">Fantoccini Basics</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/testing/manual">Manual Testing</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/styling">Styling</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/server-communication">Communicating with a Server</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/stores">Stores</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/exporting">Static Exporting</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/intro">Plugins</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/functional">Functional Actions</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/control">Control Actions</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/using">Using Plugins</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/tinker">The <code>tinker</code> Action</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/writing">Writing Plugins</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/security">Security Considerations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/plugins/publishing">Publishing Plugins</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/intro">Deploying</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/serverful">Server Deployment</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/serverless">Serverless Deployment</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/size">Optimizing Code Size</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/relative-paths">Relative Paths</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/deploying/docker">Docker Deployment</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/updating">Migrating from v0.2.x</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/pitfalls-and-bugs">Common Pitfalls and Known Bugs</a></li>
</ul>
<hr />
<h1>Advanced</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/intro">Under the Hood</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/arch">Architecture</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/initial-loads">Initial Loads</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/subsequent-loads">Subsequent Loads</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/routing">Routing</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.3.x/advanced/define_app"><code>define_app</code> in Detail</a></li>
</ul>
</div></aside></div></div></div><div data-hk="3.21" class="h-full flex w-full"><div data-hk="3.22" class="px-3 w-full sm:mr-auto sm:ml-auto sm:max-w-prose lg:max-w-3xl xl:max-w-4xl 2xl:max-w-5xl"><!--#--><!----><!--/--><main data-hk="3.23" class="text-black dark:text-white"><div data-hk="2.0" class="markdown"><h1>Revalidation</h1>
<p>While the <em>build state</em> and <em>build paths</em> strategies are excellent for generating pages efficiently, they can't be updated for new content. For example, using these strategies alone, you'd need to rebuild a blog every time you added a new post, even if those posts were stored in a database. With <em>revalidation</em>, you can avoid this by instructing Perseus to rebuild a template if certain criteria are met when it's requested.</p>
<p>There are two types of revalidation: time-based and logic-based. The former lets you re-render a template every 24 hours or the like, while the latter allows you to re-render a template if an arbitrary function returns <code>true</code>.</p>
<h2>Time-Based Revalidation Usage</h2>
<p>Here's an example of time-based revalidation from <a href="https://github.com/arctic-hen7/perseus/blob/main/examples/showcase/src/templates/time.rs">here</a> (note that this uses <em>incremental generation</em> as well):</p>
<pre><code class="language-rust">use perseus::{
    ErrorCause, GenericErrorWithCause, RenderFnResult, RenderFnResultWithCause, Template,
};
use serde::{Deserialize, Serialize};
use sycamore::prelude::{component, view, Html, View};

#[derive(Serialize, Deserialize, Debug)]
pub struct TimePageProps {
    pub time: String,
}

#[perseus::template(TimePage)]
#[component(TimePage&lt;G&gt;)]
pub fn time_page(props: TimePageProps) -&gt; View&lt;G&gt; {
    view! {
        p { (format!(&quot;The time when this page was last rendered was '{}'.&quot;, props.time)) }
    }
}

pub fn get_template&lt;G: Html&gt;() -&gt; Template&lt;G&gt; {
    Template::new(&quot;timeisr&quot;)
        .template(time_page)
        // This page will revalidate every five seconds (to illustrate revalidation)
        .revalidate_after(&quot;5s&quot;.to_string())
        .incremental_generation()
        .build_state_fn(get_build_state)
        .build_paths_fn(get_build_paths)
}

#[perseus::autoserde(build_state)]
pub async fn get_build_state(
    path: String,
    _locale: String,
) -&gt; RenderFnResultWithCause&lt;TimePageProps&gt; {
    // This path is illegal, and can't be rendered
    if path == &quot;timeisr/tests&quot; {
        return Err(GenericErrorWithCause {
            error: &quot;illegal page&quot;.into(),
            cause: ErrorCause::Client(Some(404)),
        });
    }
    Ok(TimePageProps {
        time: format!(&quot;{:?}&quot;, std::time::SystemTime::now()),
    })
}

pub async fn get_build_paths() -&gt; RenderFnResult&lt;Vec&lt;String&gt;&gt; {
    Ok(vec![&quot;test&quot;.to_string()])
}

</code></pre>
<p>This page displays the time at which it was built (fetched with <em>build state</em>), but rebuilds every five seconds. Note that this doesn't translate to the server's actually rebuilding it every five seconds, but rather the server will rebuild it at the next request if more than five seconds have passed since it was last built (meaning templates on the same build schedule will likely go our of sync quickly).</p>
<h3>Time Syntax</h3>
<p>Perseus uses a very simple syntax inspired by <a href="">this JavaScript project</a> to specify time intervals in the form <code>xXyYzZ</code> (e.g. <code>1w</code>, <code>5s</code>, <code>1w5s</code>), where the lower-case letters are number and the upper-case letters are intervals, the supported of which are listed below:</p>
<ul>
<li><code>s</code>: second,</li>
<li><code>m</code>: minute,</li>
<li><code>h</code>: hour,</li>
<li><code>d</code>: day,</li>
<li><code>w</code>: week,</li>
<li><code>M</code>: month (30 days used here, 12M ≠ 1y!),</li>
<li><code>y</code>: year (365 days always, leap years ignored, if you want them add them as days)</li>
</ul>
<h2>Logic-Based Revalidation Usage</h2>
<p>Here's an example of logic-based revalidation from <a href="https://github.com/arctic-hen7/perseus/blob/main/examples/showcase/src/templates/time_root.rs">here</a> (actually, this example uses both types of revalidation):</p>
<pre><code class="language-rust">use perseus::{RenderFnResultWithCause, Template};
use serde::{Deserialize, Serialize};
use sycamore::prelude::{component, view, Html, View};

#[derive(Serialize, Deserialize, Debug)]
pub struct TimePageProps {
    pub time: String,
}

#[perseus::template(TimePage)]
#[component(TimePage&lt;G&gt;)]
pub fn time_page(props: TimePageProps) -&gt; View&lt;G&gt; {
    view! {
        p { (format!(&quot;The time when this page was last rendered was '{}'.&quot;, props.time)) }
    }
}

pub fn get_template&lt;G: Html&gt;() -&gt; Template&lt;G&gt; {
    Template::new(&quot;time&quot;)
        .template(time_page)
        // This page will revalidate every five seconds (to illustrate revalidation)
        // Try changing this to a week, even though the below custom logic says to always revalidate, we'll only do it weekly
        .revalidate_after(&quot;5s&quot;.to_string())
        .should_revalidate_fn(|| async { Ok(true) })
        .build_state_fn(get_build_state)
}

#[perseus::autoserde(build_state)]
pub async fn get_build_state(
    _path: String,
    _locale: String,
) -&gt; RenderFnResultWithCause&lt;TimePageProps&gt; {
    Ok(TimePageProps {
        time: format!(&quot;{:?}&quot;, std::time::SystemTime::now()),
    })
}

</code></pre>
<p>If it were just <code>.should_revalidate_fn()</code> being called here, this page would always be rebuilt every time it's requested (the closure always returns <code>true</code>, note that errors would be <code>String</code>s), however, the additional usage of time-based revalidation regulates this, and the page will only be rebuilt every five seconds. In short, your arbitrary revalidation logic will only be executed at the intervals of your time-based revalidation intervals (if none are set, it will run on every request).</p>
<p>Note that you should avoid lengthy operations in revalidation if at all possible, as, like the <em>request state</em> strategy, this logic will be executed while the client is waiting for their page to load.</p>
</div></main></div></div></div></div><footer class="w-full flex justify-center py-5 bg-gray-100 dark:bg-navy-deep" data-hk="3.24"><p data-hk="3.25" class="dark:text-white mx-5 text-center"><span data-hk="3.26">© <a href="https://github.com/arctic-hen7" class="underline">arctic-hen7</a> ⁨2021⁩, see license <a href="https://github.com/arctic-hen7/perseus/blob/main/LICENSE" class="underline">here</a>.</span></p></footer><script src=".perseus/static/prism.js" defer="" data-hk="2.1"></script><script data-hk="2.2">window.Prism.highlightAll();</script></div></div>
    </body>
</html>
