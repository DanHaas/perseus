<!DOCTYPE html>
<html lang="en" class="light">
    <head>
<base href="https://arctic-hen7.github.io/perseus/" />
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href=".perseus/static/tailwind.css" />
        <link rel="stylesheet" href=".perseus/static/styles/style.css" />
    <script>window.__PERSEUS_RENDER_CFG = '{"docs/next/reference/pitfalls-and-bugs":"docs","docs/0.3.x/stores":"docs","docs/next/reference/plugins/intro":"docs","docs/next/reference/plugins/using":"docs","docs/0.2.x/testing/checkpoints":"docs","docs/views":"docs","docs/0.3.x/advanced/initial-loads":"docs","docs/0.3.x/pitfalls-and-bugs":"docs","docs/0.2.x/i18n/other-engines":"docs","docs/0.1.x/intro":"docs","docs/0.1.x/integrations/actix-web":"docs","docs/next/reference/stores":"docs","index":"index","docs/0.3.x/deploying/relative-paths":"docs","docs/0.3.x/deploying/serverful":"docs","docs/deploying/intro":"docs","docs/next/reference/engines":"docs","docs/0.3.x/i18n/intro":"docs","docs/next/reference/deploying/serverful":"docs","docs/strategies/build-paths":"docs","docs/templates/setting-headers":"docs","docs/plugins/publishing":"docs","docs/strategies/incremental":"docs","docs/0.3.x/templates/metadata-modification":"docs","docs/next/reference/strategies/build-paths":"docs","docs/exporting":"docs","docs/0.3.x/static-content":"docs","docs/0.2.x/second-app":"docs","docs/next/tutorials/hello-world":"docs","docs/0.1.x/tutorials/first_app/template":"docs","docs/next/reference/deploying/intro":"docs","docs/next/reference/ejecting":"docs","docs/next/reference/server-communication":"docs","docs/0.2.x/hello-world":"docs","docs/next/advanced/define_app":"docs","docs/0.2.x/deploying/exporting":"docs","docs/0.2.x/updating":"docs","docs/plugins/intro":"docs","docs/0.2.x/templates/setting-headers":"docs","docs/0.3.x/cli":"docs","docs/0.1.x/serving":"docs","docs/0.2.x/views":"docs","docs/next/reference/debugging":"docs","docs/0.1.x/templates":"docs","docs/0.1.x/strategies/revalidation":"docs","docs/0.3.x/snooping":"docs","docs/0.3.x/templates/intro":"docs","docs/0.2.x/i18n/using":"docs","docs/next/intro":"docs","docs/testing/fantoccini-basics":"docs","docs/0.3.x/error-pages":"docs","docs/0.3.x/deploying/serverless":"docs","docs/next/reference/templates/intro":"docs","docs/0.2.x/advanced/arch":"docs","docs/next/reference/templates/setting-headers":"docs","docs/next/reference/error-pages":"docs","docs/plugins/control":"docs","docs/0.3.x/testing/fantoccini-basics":"docs","docs/0.3.x/styling":"docs","docs/next/reference/deploying/relative-paths":"docs","docs/0.3.x/views":"docs","docs/i18n/intro":"docs","docs/debugging":"docs","docs/0.3.x/i18n/translations-managers":"docs","docs/next/core-principles":"docs","docs/strategies/build-state":"docs","docs/next/reference/cli":"docs","docs/0.2.x/styling":"docs","docs/styling":"docs","docs/0.2.x/error-pages":"docs","docs/i18n/translations-managers":"docs","docs/0.2.x/advanced/subsequent-loads":"docs","docs/0.3.x/second-app":"docs","docs/next/reference/updating":"docs","docs/0.3.x/plugins/intro":"docs","docs/0.2.x/i18n/intro":"docs","docs/next/advanced/routing":"docs","docs/0.3.x/testing/intro":"docs","docs/next/reference/i18n/other-engines":"docs","docs/0.1.x/routing":"docs","docs/0.3.x/exporting":"docs","docs/0.2.x/templates/intro":"docs","docs/next/reference/hydration":"docs","docs/next/reference/i18n/using":"docs","docs/next/reference/snooping":"docs","docs/next/reference/deploying/docker":"docs","docs/0.3.x/intro":"docs","docs/error-pages":"docs","docs/next/reference/i18n/translations-managers":"docs","docs/deploying/docker":"docs","docs/0.3.x/plugins/security":"docs","docs/testing/manual":"docs","docs/next/tutorials/second-app":"docs","docs/deploying/serverful":"docs","docs/next/reference/plugins/security":"docs","docs/plugins/using":"docs","docs/0.2.x/advanced/initial-loads":"docs","docs/0.3.x/plugins/functional":"docs","docs/testing/checkpoints":"docs","docs/next/advanced/initial-loads":"docs","docs/i18n/using":"docs","docs/0.3.x/strategies/build-paths":"docs","docs/0.3.x/what-is-perseus":"docs","docs/next/reference/testing/fantoccini-basics":"docs","docs/next/reference/testing/manual":"docs","docs/0.1.x/building":"docs","docs/next/reference/i18n/intro":"docs","docs/0.1.x/setup":"docs","docs/0.2.x/define-app":"docs","docs/advanced/subsequent-loads":"docs","docs/plugins/tinker":"docs","docs/hello-world":"docs","docs/intro":"docs","docs/next/advanced/arch":"docs","docs/0.1.x/arch":"docs","docs/strategies/amalgamation":"docs","docs/what-is-perseus":"docs","docs/next/reference/state/freezing":"docs","docs/hydration":"docs","docs/advanced/routing":"docs","docs/pitfalls-and-bugs":"docs","docs/plugins/writing":"docs","docs/0.2.x/strategies/build-paths":"docs","docs/0.3.x/plugins/publishing":"docs","docs/advanced/initial-loads":"docs","docs/next/reference/strategies/incremental":"docs","docs/i18n/defining":"docs","docs/advanced/define_app":"docs","docs/templates/intro":"docs","docs/0.2.x/strategies/build-state":"docs","docs/updating":"docs","docs/0.3.x/strategies/request-state":"docs","docs/0.2.x/strategies/amalgamation":"docs","comparisons":"comparisons","docs/0.1.x/error_pages":"docs","plugins":"plugins","docs/strategies/request-state":"docs","docs/0.3.x/testing/manual":"docs","docs/0.2.x/deploying/intro":"docs","docs/0.2.x/i18n/defining":"docs","docs/strategies/revalidation":"docs","docs/0.2.x/what-is-perseus":"docs","docs/0.1.x/strategies/request_state":"docs","docs/next/advanced/subsequent-loads":"docs","docs/advanced/intro":"docs","docs/cli":"docs","docs/next/reference/strategies/build-state":"docs","docs/templates/metadata-modification":"docs","docs/0.3.x/plugins/using":"docs","docs/next/reference/plugins/functional":"docs","docs/next/reference/plugins/writing":"docs","docs/0.3.x/i18n/defining":"docs","docs/stores":"docs","docs/0.1.x/tutorials/first_app/setup":"docs","docs/0.3.x/deploying/docker":"docs","docs/0.2.x/ejecting":"docs","docs/0.2.x/testing/intro":"docs","docs/0.3.x/strategies/amalgamation":"docs","docs/next/reference/views":"docs","docs/next/reference/testing/checkpoints":"docs","docs/0.1.x/config_managers":"docs","docs/next/reference/plugins/publishing":"docs","docs/deploying/relative-paths":"docs","docs/deploying/serverless":"docs","docs/0.1.x/strategies/intro":"docs","docs/0.2.x/testing/manual":"docs","docs/0.3.x/strategies/revalidation":"docs","docs/0.2.x/i18n/translations-managers":"docs","docs/0.2.x/cli":"docs","docs":"docs","docs/define-app":"docs","docs/0.2.x/advanced/routing":"docs","docs/0.1.x/tutorials/first_app/app":"docs","docs/0.3.x/strategies/incremental":"docs","docs/0.2.x/testing/fantoccini-basics":"docs","docs/0.3.x/plugins/writing":"docs","docs/next/reference/strategies/intro":"docs","docs/snooping":"docs","docs/0.3.x/plugins/tinker":"docs","docs/0.3.x/advanced/intro":"docs","docs/0.2.x/templates/metadata-modification":"docs","docs/0.3.x/i18n/other-engines":"docs","docs/0.2.x/config-managers":"docs","docs/0.2.x/static-content":"docs","docs/0.3.x/advanced/routing":"docs","docs/next/reference/strategies/revalidation":"docs","docs/plugins/functional":"docs","docs/0.3.x/hydration":"docs","docs/0.2.x/strategies/incremental":"docs","docs/0.1.x/strategies/incremental":"docs","docs/deploying/size":"docs","docs/0.3.x/advanced/subsequent-loads":"docs","docs/0.1.x/strategies/build_paths":"docs","docs/next/reference/static-content":"docs","docs/0.3.x/i18n/using":"docs","docs/0.3.x/strategies/intro":"docs","docs/next/reference/exporting":"docs","docs/advanced/arch":"docs","docs/next/what-is-perseus":"docs","docs/0.3.x/debugging":"docs","docs/next/reference/deploying/serverless":"docs","docs/0.3.x/ejecting":"docs","docs/0.2.x/intro":"docs","docs/next/reference/state/rx":"docs","docs/next/reference/styling":"docs","docs/0.2.x/strategies/intro":"docs","docs/0.1.x/cli":"docs","docs/next/reference/templates/router-state":"docs","docs/next/reference/testing/intro":"docs","docs/0.3.x/testing/checkpoints":"docs","docs/next/advanced/intro":"docs","docs/0.3.x/server-communication":"docs","docs/second-app":"docs","docs/server-communication":"docs","docs/0.3.x/advanced/arch":"docs","docs/0.1.x/strategies/build_state":"docs","docs/plugins/security":"docs","docs/next/reference/templates/metadata-modification":"docs","docs/0.1.x/tutorials/first_app/intro":"docs","docs/ejecting":"docs","docs/i18n/other-engines":"docs","docs/0.3.x/plugins/control":"docs","docs/0.3.x/hello-world":"docs","docs/0.3.x/updating":"docs","docs/next/reference/plugins/control":"docs","docs/0.3.x/advanced/define_app":"docs","docs/next/reference/i18n/defining":"docs","docs/next/reference/deploying/size":"docs","docs/0.2.x/strategies/request-state":"docs","docs/0.2.x/advanced/intro":"docs","docs/0.2.x/debugging":"docs","docs/0.3.x/deploying/intro":"docs","docs/next/reference/define-app":"docs","docs/0.3.x/strategies/build-state":"docs","docs/next/reference/plugins/tinker":"docs","docs/strategies/intro":"docs","docs/next/reference/strategies/request-state":"docs","docs/next/reference/state/global":"docs","docs/next/reference/strategies/amalgamation":"docs","docs/0.2.x/strategies/revalidation":"docs","docs/0.3.x/define-app":"docs","docs/0.3.x/templates/setting-headers":"docs","docs/testing/intro":"docs","docs/next/reference/state/idb-freezing":"docs","docs/0.3.x/deploying/size":"docs","docs/static-content":"docs"}';</script>
<script type="module">
    import init, { run } from "https://arctic-hen7.github.io/perseus/.perseus/bundle.js";
    async function main() {
        await init("https://arctic-hen7.github.io/perseus/.perseus/bundle.wasm");
        run();
    }
    main();
</script>
<!--PERSEUS_INTERPOLATED_HEAD_BEGINS--><title data-hk="1.0">Global State | Perseus Docs</title><link rel="stylesheet" href=".perseus/static/styles/markdown.css" data-hk="1.1"/><link data-hk="1.2" rel="stylesheet" href=".perseus/static/styles/docs_links_markdown.css"/><link data-hk="1.3" rel="stylesheet" href=".perseus/static/prism.css"/>
<script>window.__PERSEUS_INITIAL_STATE = `{"title":"Global State","content":"<h1>Global State</h1>\\n<p>As you've seen, Perseus has full support for reactive state in templates, but what about state that's not associated with any template? The usual example is something like dark mode, which the user might manually disable. In most JavaScript frameworks, you'd bring in some bloated state management system to handle this, but Perseus has global state built in. To declare it, you create a <code>GlobalStateCreator</code>, which will be used to generate some state, and then that'll be made reactive and passed to your templates as their second argument (if they have one, and you'll have to use the <code>#[template_rx(...)]</code> macro).</p>\\n<p>The essence of global state is that you can generate it at build-time (though with something like setting dark mode, you'll probably want to ignore whatever was set at build time until you know the browser's preferences) and access it seamlessly from any template. Just like usual <a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/state/rx\\">reactive state</a>, you can make it reactive with <code>#[make_rx(...)]</code>, and you essentially get app-wide MVC with just a few lines of code (and no extra dependencies, all this is completely built into Perseus).</p>\\n<details>\\n<summary>How would I actually implement dark mode like this?</summary>\\n<p>Above is a contrived example. In reality, dark mode is set in two ways: the preference that the browser exposes and the user's own manual setting (usually through a toggle switch in the header or similar). You obviously don't want to start in light mode and then flicker to dark mode once you know the user's preference, that would be awful, so it's far better to rely on a class in the HTML (e.g. if <code>dark</code> is set on the <code>&lt;body&gt;</code>, certain things should be styled in different ways) that you set based on a cookie that you've stored, falling back to the <code>prefers-color-scheme</code> if there's no cookie yet. Perseus is designed to load content and then make it interactive, so if you do this cookie-checking in your Wasm ode, you'll be too late to avoid that flicker, which is why it's better to either do this with a separate Wasm bundle, or with a quick bit of JS written directly into your <code>index.html</code> file. There are plenty of guides on how to achieve this online.</p>\\n<p>The role of dark mode comes in in styling that toggle switch mostly, and whenever it changes, you should toggle the <code>dark</code> class on the <code>&lt;body&gt;</code> or similar and update the global state. YOu could to the class toggling with a <code>create_effect</code> that listens for changes in the global state. So, in this case, global state actually isn't crucial, it just makes things cleaner and easier to set up. Unfortunately though, dark mode is irritating with any prerendering because you want to avoid that flicker. (That said, if you don't mind temporarily blinding your 3am users, do whatever you like!)</p>\\n</details>\\n<h2>Example</h2>\\n<p>All the following examples are taken from <a href=\\"https://github.com/arctic-hen7/perseus/blob/main/examples/rx_state\\">here</a>.</p>\\n<p>To being with, you'll need to set up a <code>GlobalStateCreator</code>, which will look something like this (it's supposed to be fairly similar to the process of generating state for a <code>Template</code>, but it currently only supports build-time state generation):</p>\\n<pre><code class=\\"language-rust\\">use perseus::{state::GlobalStateCreator, RenderFnResult};\\n\\npub fn get_global_state_creator() -&gt; GlobalStateCreator {\\n    GlobalStateCreator::new().build_state_fn(get_build_state)\\n}\\n\\n#[perseus::make_rx(AppStateRx)]\\npub struct AppState {\\n    pub test: String,\\n}\\n\\n#[perseus::autoserde(global_build_state)]\\npub async fn get_build_state() -&gt; RenderFnResult&lt;AppState&gt; {\\n    Ok(AppState {\\n        test: &quot;Hello from the global state build process!&quot;.to_string(),\\n    })\\n}\\n\\n</code></pre>\\n<p>Then, you can tell Perseus about that by adding it to <code>define_app!</code> like so:</p>\\n<pre><code class=\\"language-rust\\">mod about;\\nmod global_state;\\nmod idb;\\nmod index;\\nmod test;\\n\\nuse perseus::define_app;\\n\\ndefine_app! {\\n    templates: [\\n        index::get_template::&lt;G&gt;(),\\n        test::get_template::&lt;G&gt;(),\\n        about::get_template::&lt;G&gt;(),\\n        idb::get_template::&lt;G&gt;()\\n    ],\\n    error_pages: perseus::ErrorPages::new(|url, status, err, _| {\\n        sycamore::view! {\\n            p { (format!(&quot;An error with HTTP code {} occurred at '{}': '{}'.&quot;, status, url, err)) }\\n        }\\n    }),\\n    global_state_creator: global_state::get_global_state_creator()\\n}\\n\\n</code></pre>\\n<p>Finally, you can use it like so (note the second argument to <code>index_page</code>):</p>\\n<pre><code class=\\"language-rust\\">use perseus::state::Freeze;\\nuse perseus::{Html, RenderFnResultWithCause, Template};\\nuse sycamore::prelude::*;\\n\\nuse crate::global_state::AppStateRx;\\n\\n// We define a normal \`struct\` and then use \`make_rx\` (which derives \`Serialize\`, \`Deserialize\`, and \`Clone\` automatically)\\n// This will generate a new \`struct\` called \`IndexPropsRx\` (as we asked it to), in which every field is made reactive with a \`Signal\`\\n#[perseus::make_rx(IndexPropsRx)]\\npub struct IndexProps {\\n    pub username: String,\\n}\\n\\n// This special macro (normally we'd use \`template(IndexProps)\`) converts the state we generate elsewhere to a reactive version\\n// We need to tell it the name of the unreactive properties we created to start with (unfortunately the compiler isn't smart enough to figure that out yet)\\n// This will also add our reactive properties to the global state store, and, if they're already there, it'll use the existing one\\n#[perseus::template_rx(IndexPage)]\\npub fn index_page(IndexPropsRx { username }: IndexPropsRx, global_state: AppStateRx) -&gt; View&lt;G&gt; {\\n    let username_2 = username.clone(); // This is necessary until Sycamore's new reactive primitives are released\\n    let frozen_app = Signal::new(String::new()); // This is not part of our data model, so it's not part of the state properties (everything else should be though)\\n    let frozen_app_2 = frozen_app.clone();\\n    let frozen_app_3 = frozen_app.clone();\\n    let render_ctx = perseus::get_render_ctx!();\\n\\n    view! {\\n        p { (format!(&quot;Greetings, {}!&quot;, username.get())) }\\n        input(bind:value = username_2, placeholder = &quot;Username&quot;)\\n        p { (global_state.test.get()) }\\n\\n        // When the user visits this and then comes back, they'll still be able to see their username (the previous state will be retrieved from the global state automatically)\\n        a(href = &quot;about&quot;) { &quot;About&quot; }\\n        br()\\n\\n        button(on:click = cloned!(frozen_app, render_ctx =&gt; move |_| {\\n            frozen_app.set(render_ctx.freeze());\\n        })) { &quot;Freeze!&quot; }\\n        p { (frozen_app.get()) }\\n\\n        input(bind:value = frozen_app_2, placeholder = &quot;Frozen state&quot;)\\n        button(on:click = cloned!(frozen_app_3, render_ctx =&gt; move |_| {\\n            render_ctx.thaw(&amp;frozen_app_3.get(), perseus::state::ThawPrefs {\\n                page: perseus::state::PageThawPrefs::IncludeAll,\\n                global_prefer_frozen: true\\n            }).unwrap();\\n        })) { &quot;Thaw...&quot; }\\n    }\\n}\\n\\npub fn get_template&lt;G: Html&gt;() -&gt; Template&lt;G&gt; {\\n    Template::new(&quot;index&quot;)\\n        .build_state_fn(get_build_state)\\n        .template(index_page)\\n}\\n\\n#[perseus::autoserde(build_state)]\\npub async fn get_build_state(\\n    _path: String,\\n    _locale: String,\\n) -&gt; RenderFnResultWithCause&lt;IndexProps&gt; {\\n    Ok(IndexProps {\\n        username: &quot;&quot;.to_string(),\\n    })\\n}\\n\\n</code></pre>\\n<h2>Potential Issues</h2>\\n<p>Global state has a quirk that shouldn't be an issue for most, but that can be very helpful to know about if you start to dig into the internals of Perseus. Global state is passed down from the server as a window-level JS variable (as with template state), but it doesn't immediately get deserialized and registered, it's loaded lazily. So, if the user loads fifty templates that don't access global state, your app won't initialize the global state. But, the moment you take it as an argument to a template, it will be set up. This means that, while you can access the global state through the render context (with <code>perseus::get_render_ctx!()</code>), you shouldn't do this except in templates that already take the global state as an argument. It may seem tempting to assume that the user has already gone to another page which has set up global state, but no matter how the flow of your app works, you mustn't assume this because of <a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/state/freezing\\">state freezing</a>, which can break such flows. Basically, don't access the global state through the render context, you almost never need to and it may be wrong. Trust in <code>#[template_rx(...)]</code>.</p>\\n","sidebar_content":"<h1>Introduction</h1>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/intro\\">Introduction</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/what-is-perseus\\">What is Perseus?</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/core-principles\\">Core Principles</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/tutorials/hello-world\\">Hello World!</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/tutorials/second-app\\">Your Second App</a></li>\\n</ul>\\n<hr />\\n<h1>Reference</h1>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/define-app\\"><code>define_app!</code></a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/views\\">Writing Views</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/debugging\\">Debugging</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/templates/intro\\">Templates and Routing</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/templates/metadata-modification\\">Modifying the <code>&lt;head&gt;</code></a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/templates/setting-headers\\">Modifying HTTP Headers</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/templates/router-state\\">Listening to the Router</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/error-pages\\">Error Pages</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/static-content\\">Static Content</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/i18n/intro\\">Internationalization</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/i18n/defining\\">Defining Translations</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/i18n/using\\">Using Translations</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/i18n/translations-managers\\">Translations Managers</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/i18n/other-engines\\">Other Translation Engines</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/intro\\">Rendering Strategies</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/build-state\\">Build State</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/build-paths\\">Build Paths</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/request-state\\">Request State</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/revalidation\\">Revalidation</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/incremental\\">Incremental Generation</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/amalgamation\\">State Amalgamation</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/hydration\\">Hydration</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/state/rx\\">Reactive State</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/state/global\\">Global State</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/state/freezing\\">State Freezing</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/state/idb-freezing\\">Freezing to IndexedDB</a></li>\\n</ul>\\n</li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/cli\\">CLI</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/ejecting\\">Ejecting</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/snooping\\">Snooping</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/testing/intro\\">Testing</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/testing/checkpoints\\">Checkpoints</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/testing/fantoccini-basics\\">Fantoccini Basics</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/testing/manual\\">Manual Testing</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/styling\\">Styling</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/server-communication\\">Communicating with a Server</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/stores\\">Stores</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/exporting\\">Static Exporting</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/intro\\">Plugins</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/functional\\">Functional Actions</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/control\\">Control Actions</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/using\\">Using Plugins</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/tinker\\">The <code>tinker</code> Action</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/writing\\">Writing Plugins</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/security\\">Security Considerations</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/publishing\\">Publishing Plugins</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/engines\\">Engines</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/intro\\">Deploying</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/serverful\\">Server Deployment</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/serverless\\">Serverless Deployment</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/size\\">Optimizing Code Size</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/relative-paths\\">Relative Paths</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/docker\\">Docker Deployment</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/updating\\">Migrating from v0.2.x</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/pitfalls-and-bugs\\">Common Pitfalls and Known Bugs</a></li>\\n</ul>\\n<hr />\\n<h1>Advanced</h1>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/intro\\">Under the Hood</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/arch\\">Architecture</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/initial-loads\\">Initial Loads</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/subsequent-loads\\">Subsequent Loads</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/routing\\">Routing</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/define_app\\"><code>define_app</code> in Detail</a></li>\\n</ul>\\n","status":"Next","manifest":{"stable":"0.3.x","outdated":["0.2.x","0.1.x"],"beta":[],"history_map":{"0.2.x":"v0.2.3","0.1.x":"v0.1.4","0.3.x":"HEAD"}},"current_version":"next"}`;</script>
</head>
    <body class="bg-white dark:bg-navy">
        <div id="root"><div id="__perseus_content_initial" class="__perseus_content"><header class="shadow-md sm:p-2 w-full bg-white dark:text-white dark:bg-navy mb-20" data-hk="3.0"><div data-hk="3.1" class="flex justify-between"><a class="justify-self-start self-center m-3 ml-5 text-md sm:text-2xl" href="en-US/" data-hk="3.2">Perseus</a><div class="md:hidden m-3 mr-5 tham tham-e-spin tham-w-6 " data-hk="3.3"><div data-hk="3.4" class="tham-box"><div data-hk="3.5" class="dark:bg-white tham-inner"></div></div></div><nav class="hidden md:flex" data-hk="3.6"><ul data-hk="3.7" class="mr-5 flex"><li data-hk="4.0" class="m-3 p-1"><a data-hk="4.1" class="px-2" href="en-US/docs">Docs</a></li><li class="m-3 p-1" data-hk="4.2"><a class="px-2" href="en-US/comparisons" data-hk="4.3">Comparisons</a></li><li class="m-3 p-1" data-hk="4.4"><a href="en-US/plugins" class="px-2" data-hk="4.5">Plugins</a></li></ul></nav></div><nav data-hk="3.8" id="mobile_nav_menu" class="md:hidden w-full text-center justify-center overflow-y-scroll hidden"><div style="max-height: 500px" class="mr-5 overflow-y-scroll" data-hk="3.9"><ul data-hk="3.10"><li class="m-3 p-1" data-hk="5.0"><a href="en-US/docs" data-hk="5.1" class="px-2">Docs</a></li><li data-hk="5.2" class="m-3 p-1"><a href="en-US/comparisons" class="px-2" data-hk="5.3">Comparisons</a></li><li class="m-3 p-1" data-hk="5.4"><a data-hk="5.5" href="en-US/plugins" class="px-2">Plugins</a></li></ul><hr data-hk="3.11"/><div class="text-left p-3" data-hk="3.12"><!--#--><!----><select class="p-2 rounded-md text-white bg-indigo-500" data-hk="6.0"><option selected="" data-hk="6.1" value="next">Next (unreleased)</option><!--#--><!--/--><option data-hk="6.2" value="0.3.x">v⁨0.3.x⁩ (stable)</option><!--#--><option value="0.2.x" data-hk="6.3">v⁨0.2.x⁩ (outdated)</option><option value="0.1.x" data-hk="6.4">v⁨0.1.x⁩ (outdated)</option><!--/--></select><!--/--><div class="docs-links-markdown" data-hk="3.13"><h1>Introduction</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/intro">Introduction</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/what-is-perseus">What is Perseus?</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/core-principles">Core Principles</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/tutorials/hello-world">Hello World!</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/tutorials/second-app">Your Second App</a></li>
</ul>
<hr />
<h1>Reference</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/define-app"><code>define_app!</code></a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/views">Writing Views</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/debugging">Debugging</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/templates/intro">Templates and Routing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/templates/metadata-modification">Modifying the <code>&lt;head&gt;</code></a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/templates/setting-headers">Modifying HTTP Headers</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/templates/router-state">Listening to the Router</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/error-pages">Error Pages</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/static-content">Static Content</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/i18n/intro">Internationalization</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/i18n/defining">Defining Translations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/i18n/using">Using Translations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/i18n/translations-managers">Translations Managers</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/i18n/other-engines">Other Translation Engines</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/intro">Rendering Strategies</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/build-state">Build State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/build-paths">Build Paths</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/request-state">Request State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/revalidation">Revalidation</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/incremental">Incremental Generation</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/amalgamation">State Amalgamation</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/hydration">Hydration</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/state/rx">Reactive State</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/state/global">Global State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/state/freezing">State Freezing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/state/idb-freezing">Freezing to IndexedDB</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/cli">CLI</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/ejecting">Ejecting</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/snooping">Snooping</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/testing/intro">Testing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/testing/checkpoints">Checkpoints</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/testing/fantoccini-basics">Fantoccini Basics</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/testing/manual">Manual Testing</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/styling">Styling</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/server-communication">Communicating with a Server</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/stores">Stores</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/exporting">Static Exporting</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/intro">Plugins</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/functional">Functional Actions</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/control">Control Actions</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/using">Using Plugins</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/tinker">The <code>tinker</code> Action</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/writing">Writing Plugins</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/security">Security Considerations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/publishing">Publishing Plugins</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/engines">Engines</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/intro">Deploying</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/serverful">Server Deployment</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/serverless">Serverless Deployment</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/size">Optimizing Code Size</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/relative-paths">Relative Paths</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/docker">Docker Deployment</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/updating">Migrating from v0.2.x</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/pitfalls-and-bugs">Common Pitfalls and Known Bugs</a></li>
</ul>
<hr />
<h1>Advanced</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/intro">Under the Hood</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/arch">Architecture</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/initial-loads">Initial Loads</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/subsequent-loads">Subsequent Loads</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/routing">Routing</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/define_app"><code>define_app</code> in Detail</a></li>
</ul>
</div></div></div></nav></header><div class="mt-14 xs:mt-16 sm:mt-20 lg:mt-25 overflow-y-auto flex" data-hk="3.14"><div data-hk="3.15" class="flex w-full"><div data-hk="3.16" class="h-full hidden md:block max-w-xs w-full border-r"><div data-hk="3.17" class="mr-5"><div data-hk="3.18" class="text-left text-black dark:text-white p-3"><aside data-hk="3.19"><!--#--><!----><select data-hk="7.0" class="p-2 rounded-md text-white bg-indigo-500"><option value="next" selected="" data-hk="7.1">Next (unreleased)</option><!--#--><!--/--><option data-hk="7.2" value="0.3.x">v⁨0.3.x⁩ (stable)</option><!--#--><option value="0.2.x" data-hk="7.3">v⁨0.2.x⁩ (outdated)</option><option data-hk="7.4" value="0.1.x">v⁨0.1.x⁩ (outdated)</option><!--/--></select><!--/--><div class="docs-links-markdown" data-hk="3.20"><h1>Introduction</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/intro">Introduction</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/what-is-perseus">What is Perseus?</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/core-principles">Core Principles</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/tutorials/hello-world">Hello World!</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/tutorials/second-app">Your Second App</a></li>
</ul>
<hr />
<h1>Reference</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/define-app"><code>define_app!</code></a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/views">Writing Views</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/debugging">Debugging</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/templates/intro">Templates and Routing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/templates/metadata-modification">Modifying the <code>&lt;head&gt;</code></a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/templates/setting-headers">Modifying HTTP Headers</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/templates/router-state">Listening to the Router</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/error-pages">Error Pages</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/static-content">Static Content</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/i18n/intro">Internationalization</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/i18n/defining">Defining Translations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/i18n/using">Using Translations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/i18n/translations-managers">Translations Managers</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/i18n/other-engines">Other Translation Engines</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/intro">Rendering Strategies</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/build-state">Build State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/build-paths">Build Paths</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/request-state">Request State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/revalidation">Revalidation</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/incremental">Incremental Generation</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/strategies/amalgamation">State Amalgamation</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/hydration">Hydration</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/state/rx">Reactive State</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/state/global">Global State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/state/freezing">State Freezing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/state/idb-freezing">Freezing to IndexedDB</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/cli">CLI</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/ejecting">Ejecting</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/snooping">Snooping</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/testing/intro">Testing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/testing/checkpoints">Checkpoints</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/testing/fantoccini-basics">Fantoccini Basics</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/testing/manual">Manual Testing</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/styling">Styling</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/server-communication">Communicating with a Server</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/stores">Stores</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/exporting">Static Exporting</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/intro">Plugins</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/functional">Functional Actions</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/control">Control Actions</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/using">Using Plugins</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/tinker">The <code>tinker</code> Action</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/writing">Writing Plugins</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/security">Security Considerations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/plugins/publishing">Publishing Plugins</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/engines">Engines</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/intro">Deploying</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/serverful">Server Deployment</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/serverless">Serverless Deployment</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/size">Optimizing Code Size</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/relative-paths">Relative Paths</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/deploying/docker">Docker Deployment</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/updating">Migrating from v0.2.x</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/pitfalls-and-bugs">Common Pitfalls and Known Bugs</a></li>
</ul>
<hr />
<h1>Advanced</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/intro">Under the Hood</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/arch">Architecture</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/initial-loads">Initial Loads</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/subsequent-loads">Subsequent Loads</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/routing">Routing</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/advanced/define_app"><code>define_app</code> in Detail</a></li>
</ul>
</div></aside></div></div></div><div class="h-full flex w-full" data-hk="3.21"><div class="px-3 w-full sm:mr-auto sm:ml-auto sm:max-w-prose lg:max-w-3xl xl:max-w-4xl 2xl:max-w-5xl" data-hk="3.22"><!--#--><div class="ring-4 ring-orange-400 p-4 rounded-lg mt-1" data-hk="3.23"><div class="flex flex-col 2xs:flex-row dark:text-white" data-hk="3.24"><span data-hk="3.25" class="self-center mr-2" style="fill: #fb923c;"><svg xmlns="http://www.w3.org/2000/svg" height="auto" viewBox="0 0 24 24" width="2.25rem" fill="\#000000"><path d="M12 7c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1s-1-.45-1-1V8c0-.55.45-1 1-1zm-.01-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm1-3h-2v-2h2v2z"/></svg></span><p data-hk="3.26">This version of the documentation is for a version that has not yet been released, and features documented here may not be present in the latest release. You can see the latest stable version of the docs <a href="en-US/docs/0.3.x/intro" class="underline">here</a>.</p></div></div><!--/--><main class="text-black dark:text-white" data-hk="3.27"><div class="markdown" data-hk="2.0"><h1>Global State</h1>
<p>As you've seen, Perseus has full support for reactive state in templates, but what about state that's not associated with any template? The usual example is something like dark mode, which the user might manually disable. In most JavaScript frameworks, you'd bring in some bloated state management system to handle this, but Perseus has global state built in. To declare it, you create a <code>GlobalStateCreator</code>, which will be used to generate some state, and then that'll be made reactive and passed to your templates as their second argument (if they have one, and you'll have to use the <code>#[template_rx(...)]</code> macro).</p>
<p>The essence of global state is that you can generate it at build-time (though with something like setting dark mode, you'll probably want to ignore whatever was set at build time until you know the browser's preferences) and access it seamlessly from any template. Just like usual <a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/state/rx">reactive state</a>, you can make it reactive with <code>#[make_rx(...)]</code>, and you essentially get app-wide MVC with just a few lines of code (and no extra dependencies, all this is completely built into Perseus).</p>
<details>
<summary>How would I actually implement dark mode like this?</summary>
<p>Above is a contrived example. In reality, dark mode is set in two ways: the preference that the browser exposes and the user's own manual setting (usually through a toggle switch in the header or similar). You obviously don't want to start in light mode and then flicker to dark mode once you know the user's preference, that would be awful, so it's far better to rely on a class in the HTML (e.g. if <code>dark</code> is set on the <code>&lt;body&gt;</code>, certain things should be styled in different ways) that you set based on a cookie that you've stored, falling back to the <code>prefers-color-scheme</code> if there's no cookie yet. Perseus is designed to load content and then make it interactive, so if you do this cookie-checking in your Wasm ode, you'll be too late to avoid that flicker, which is why it's better to either do this with a separate Wasm bundle, or with a quick bit of JS written directly into your <code>index.html</code> file. There are plenty of guides on how to achieve this online.</p>
<p>The role of dark mode comes in in styling that toggle switch mostly, and whenever it changes, you should toggle the <code>dark</code> class on the <code>&lt;body&gt;</code> or similar and update the global state. YOu could to the class toggling with a <code>create_effect</code> that listens for changes in the global state. So, in this case, global state actually isn't crucial, it just makes things cleaner and easier to set up. Unfortunately though, dark mode is irritating with any prerendering because you want to avoid that flicker. (That said, if you don't mind temporarily blinding your 3am users, do whatever you like!)</p>
</details>
<h2>Example</h2>
<p>All the following examples are taken from <a href="https://github.com/arctic-hen7/perseus/blob/main/examples/rx_state">here</a>.</p>
<p>To being with, you'll need to set up a <code>GlobalStateCreator</code>, which will look something like this (it's supposed to be fairly similar to the process of generating state for a <code>Template</code>, but it currently only supports build-time state generation):</p>
<pre><code class="language-rust">use perseus::{state::GlobalStateCreator, RenderFnResult};

pub fn get_global_state_creator() -&gt; GlobalStateCreator {
    GlobalStateCreator::new().build_state_fn(get_build_state)
}

#[perseus::make_rx(AppStateRx)]
pub struct AppState {
    pub test: String,
}

#[perseus::autoserde(global_build_state)]
pub async fn get_build_state() -&gt; RenderFnResult&lt;AppState&gt; {
    Ok(AppState {
        test: &quot;Hello from the global state build process!&quot;.to_string(),
    })
}

</code></pre>
<p>Then, you can tell Perseus about that by adding it to <code>define_app!</code> like so:</p>
<pre><code class="language-rust">mod about;
mod global_state;
mod idb;
mod index;
mod test;

use perseus::define_app;

define_app! {
    templates: [
        index::get_template::&lt;G&gt;(),
        test::get_template::&lt;G&gt;(),
        about::get_template::&lt;G&gt;(),
        idb::get_template::&lt;G&gt;()
    ],
    error_pages: perseus::ErrorPages::new(|url, status, err, _| {
        sycamore::view! {
            p { (format!(&quot;An error with HTTP code {} occurred at '{}': '{}'.&quot;, status, url, err)) }
        }
    }),
    global_state_creator: global_state::get_global_state_creator()
}

</code></pre>
<p>Finally, you can use it like so (note the second argument to <code>index_page</code>):</p>
<pre><code class="language-rust">use perseus::state::Freeze;
use perseus::{Html, RenderFnResultWithCause, Template};
use sycamore::prelude::*;

use crate::global_state::AppStateRx;

// We define a normal `struct` and then use `make_rx` (which derives `Serialize`, `Deserialize`, and `Clone` automatically)
// This will generate a new `struct` called `IndexPropsRx` (as we asked it to), in which every field is made reactive with a `Signal`
#[perseus::make_rx(IndexPropsRx)]
pub struct IndexProps {
    pub username: String,
}

// This special macro (normally we'd use `template(IndexProps)`) converts the state we generate elsewhere to a reactive version
// We need to tell it the name of the unreactive properties we created to start with (unfortunately the compiler isn't smart enough to figure that out yet)
// This will also add our reactive properties to the global state store, and, if they're already there, it'll use the existing one
#[perseus::template_rx(IndexPage)]
pub fn index_page(IndexPropsRx { username }: IndexPropsRx, global_state: AppStateRx) -&gt; View&lt;G&gt; {
    let username_2 = username.clone(); // This is necessary until Sycamore's new reactive primitives are released
    let frozen_app = Signal::new(String::new()); // This is not part of our data model, so it's not part of the state properties (everything else should be though)
    let frozen_app_2 = frozen_app.clone();
    let frozen_app_3 = frozen_app.clone();
    let render_ctx = perseus::get_render_ctx!();

    view! {
        p { (format!(&quot;Greetings, {}!&quot;, username.get())) }
        input(bind:value = username_2, placeholder = &quot;Username&quot;)
        p { (global_state.test.get()) }

        // When the user visits this and then comes back, they'll still be able to see their username (the previous state will be retrieved from the global state automatically)
        a(href = &quot;about&quot;) { &quot;About&quot; }
        br()

        button(on:click = cloned!(frozen_app, render_ctx =&gt; move |_| {
            frozen_app.set(render_ctx.freeze());
        })) { &quot;Freeze!&quot; }
        p { (frozen_app.get()) }

        input(bind:value = frozen_app_2, placeholder = &quot;Frozen state&quot;)
        button(on:click = cloned!(frozen_app_3, render_ctx =&gt; move |_| {
            render_ctx.thaw(&amp;frozen_app_3.get(), perseus::state::ThawPrefs {
                page: perseus::state::PageThawPrefs::IncludeAll,
                global_prefer_frozen: true
            }).unwrap();
        })) { &quot;Thaw...&quot; }
    }
}

pub fn get_template&lt;G: Html&gt;() -&gt; Template&lt;G&gt; {
    Template::new(&quot;index&quot;)
        .build_state_fn(get_build_state)
        .template(index_page)
}

#[perseus::autoserde(build_state)]
pub async fn get_build_state(
    _path: String,
    _locale: String,
) -&gt; RenderFnResultWithCause&lt;IndexProps&gt; {
    Ok(IndexProps {
        username: &quot;&quot;.to_string(),
    })
}

</code></pre>
<h2>Potential Issues</h2>
<p>Global state has a quirk that shouldn't be an issue for most, but that can be very helpful to know about if you start to dig into the internals of Perseus. Global state is passed down from the server as a window-level JS variable (as with template state), but it doesn't immediately get deserialized and registered, it's loaded lazily. So, if the user loads fifty templates that don't access global state, your app won't initialize the global state. But, the moment you take it as an argument to a template, it will be set up. This means that, while you can access the global state through the render context (with <code>perseus::get_render_ctx!()</code>), you shouldn't do this except in templates that already take the global state as an argument. It may seem tempting to assume that the user has already gone to another page which has set up global state, but no matter how the flow of your app works, you mustn't assume this because of <a href="https://arctic-hen7.github.io/perseus/en-US/docs/next/reference/state/freezing">state freezing</a>, which can break such flows. Basically, don't access the global state through the render context, you almost never need to and it may be wrong. Trust in <code>#[template_rx(...)]</code>.</p>
</div></main></div></div></div></div><footer class="w-full flex justify-center py-5 bg-gray-100 dark:bg-navy-deep" data-hk="3.28"><p class="dark:text-white mx-5 text-center" data-hk="3.29"><span data-hk="3.30">© <a href="https://github.com/arctic-hen7" class="underline">arctic-hen7</a> ⁨2021⁩, see license <a href="https://github.com/arctic-hen7/perseus/blob/main/LICENSE" class="underline">here</a>.</span></p></footer><script defer="" data-hk="2.1" src=".perseus/static/prism.js"></script><script data-hk="2.2">window.Prism.highlightAll();</script></div></div>
    </body>
</html>
