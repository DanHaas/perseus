<!DOCTYPE html>
<html  class="light"><head><base href="https://arctic-hen7.github.io/perseus/" />
<meta charset="UTF-8" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><link rel="stylesheet" href=".perseus/static/tailwind.css" /><link href=".perseus/static/styles/style.css"  rel="stylesheet"/>
            <script type="module">window.__PERSEUS_RENDER_CFG = '{"docs/0.3.4/reference/deploying/relative-paths":"docs","docs/reference/index-view":"docs","docs/0.2.x/i18n/using":"docs","docs/0.3.0-0.3.3/testing/intro":"docs","docs/0.4.x/reference/state/idb-freezing":"docs","docs/0.4.x/advanced/subsequent-loads":"docs","docs/reference/plugins/tinker":"docs","docs/0.3.4/reference/i18n/other-engines":"docs","docs/0.3.0-0.3.3/advanced/intro":"docs","docs/0.4.x/reference/strategies/build-paths":"docs","docs/0.4.x/reference/i18n/using":"docs","docs/0.2.x/debugging":"docs","docs/0.3.4/reference/define-app":"docs","docs/0.2.x/i18n/other-engines":"docs","plugins":"plugins","docs/0.4.x/reference/strategies/incremental":"docs","docs/0.4.x/reference/strategies/intro":"docs","docs/reference/strategies/incremental":"docs","docs/0.3.4/reference/plugins/intro":"docs","docs/reference/testing/checkpoints":"docs","docs/0.3.0-0.3.3/templates/metadata-modification":"docs","docs/0.4.x/reference/i18n/translations-managers":"docs","docs/0.3.0-0.3.3/snooping":"docs","docs/0.1.x/strategies/revalidation":"docs","docs/0.3.0-0.3.3/strategies/intro":"docs","docs/reference/templates/setting-headers":"docs","docs/0.4.x/reference/i18n/other-engines":"docs","docs/0.2.x/strategies/revalidation":"docs","docs/reference/state/global":"docs","docs/0.4.x/reference/state/freezing":"docs","docs/tutorials/second-app":"docs","docs/0.2.x/advanced/subsequent-loads":"docs","docs/0.3.4/reference/plugins/security":"docs","docs/0.1.x/strategies/request_state":"docs","docs/0.3.0-0.3.3/styling":"docs","docs/0.1.x/templates":"docs","docs/0.4.x/reference/deploying/serverless":"docs","docs/0.1.x/tutorials/first_app/app":"docs","docs/0.3.0-0.3.3/plugins/intro":"docs","docs/next/reference/deploying":"docs","docs/0.4.x/reference/strategies/amalgamation":"docs","docs/0.3.0-0.3.3/deploying/docker":"docs","docs/0.3.0-0.3.3/cli":"docs","docs/next/reference/live-reloading-and-hsr":"docs","docs/0.3.0-0.3.3/updating":"docs","docs/0.3.0-0.3.3/stores":"docs","docs/0.3.4/reference/deploying/serverful":"docs","docs/0.3.0-0.3.3/templates/setting-headers":"docs","docs/0.3.0-0.3.3/static-content":"docs","docs/0.4.x/reference/i18n/intro":"docs","docs/0.3.4/reference/server-communication":"docs","docs/0.4.x/reference/updating":"docs","docs/0.4.x/reference/plugins/writing":"docs","docs/0.3.4/reference/templates/intro":"docs","docs/0.4.x/reference/strategies/request-state":"docs","docs/0.4.x/reference/define-app":"docs","docs/0.4.x/reference/deploying/size":"docs","docs/0.3.4/reference/state/freezing":"docs","docs/0.2.x/testing/manual":"docs","docs/reference/updating":"docs","docs/0.3.4/reference/strategies/build-paths":"docs","docs/0.3.4/reference/plugins/publishing":"docs","docs/0.3.4/reference/testing/fantoccini-basics":"docs","docs/0.3.4/reference/strategies/amalgamation":"docs","docs/advanced/arch":"docs","docs/0.3.0-0.3.3/strategies/build-state":"docs","docs/0.4.x/reference/styling":"docs","docs/0.3.4/reference/error-pages":"docs","docs/0.4.x/reference/server-communication":"docs","docs/0.4.x/reference/snooping":"docs","docs/0.2.x/i18n/defining":"docs","docs/0.3.4/reference/strategies/incremental":"docs","docs/0.3.0-0.3.3/hydration":"docs","docs/0.3.4/reference/styling":"docs","docs/next/reference/plugins":"docs","docs/next/reference/exporting":"docs","docs/0.4.x/reference/i18n/defining":"docs","docs/0.3.0-0.3.3/second-app":"docs","docs/0.1.x/integrations/actix-web":"docs","docs/advanced/route-announcer":"docs","docs/0.2.x/second-app":"docs","docs/0.3.0-0.3.3/plugins/publishing":"docs","docs/0.2.x/updating":"docs","docs/0.3.4/reference/plugins/writing":"docs","docs/reference/strategies/request-state":"docs","docs/0.2.x/cli":"docs","docs/0.3.0-0.3.3/i18n/using":"docs","docs/next/what-is-perseus":"docs","docs/0.2.x/styling":"docs","docs/0.4.x/reference/strategies/build-state":"docs","docs/0.4.x/core-principles":"docs","docs/0.4.x/reference/testing/fantoccini-basics":"docs","docs/0.3.4/reference/strategies/revalidation":"docs","docs/reference/plugins/security":"docs","docs/0.1.x/serving":"docs","docs/0.3.4/reference/cli":"docs","docs/0.4.x/reference/deploying/serverful":"docs","docs/reference/pitfalls-and-bugs":"docs","docs/reference/stores":"docs","docs/0.1.x/tutorials/first_app/template":"docs","docs/next/features":"docs","docs/0.3.0-0.3.3/ejecting":"docs","docs/0.3.4/reference/deploying/intro":"docs","docs/0.4.x/reference/ejecting":"docs","docs/0.3.4/reference/plugins/tinker":"docs","docs/next/getting-started/intro":"docs","docs/0.2.x/templates/intro":"docs","docs/0.2.x/strategies/build-paths":"docs","docs/reference/static-content":"docs","docs/next/reference/faq":"docs","docs/0.2.x/static-content":"docs","docs/0.3.4/advanced/route-announcer":"docs","docs/reference/error-pages":"docs","docs/0.3.4/reference/live-reloading":"docs","docs/0.3.0-0.3.3/plugins/security":"docs","docs/0.2.x/define-app":"docs","docs/0.4.x/advanced/route-announcer":"docs","docs/0.2.x/strategies/request-state":"docs","docs/what-is-perseus":"docs","docs/0.2.x/error-pages":"docs","docs/0.1.x/tutorials/first_app/intro":"docs","docs/reference/strategies/revalidation":"docs","docs/0.2.x/deploying/exporting":"docs","docs/0.2.x/strategies/build-state":"docs","docs/0.2.x/strategies/intro":"docs","docs/0.4.x/reference/state/hsr":"docs","docs/0.3.4/reference/deploying/serverless":"docs","docs/0.4.x/reference/error-pages":"docs","docs/0.4.x/reference/testing/intro":"docs","docs/reference/deploying/docker":"docs","docs/reference/plugins/using":"docs","docs/0.3.4/reference/templates/setting-headers":"docs","docs/0.3.4/reference/testing/checkpoints":"docs","docs/0.3.0-0.3.3/server-communication":"docs","docs/reference/engines":"docs","docs/0.4.x/tutorials/hello-world":"docs","docs/reference/exporting":"docs","docs/reference/state/hsr":"docs","docs/reference/plugins/control":"docs","docs/0.4.x/reference/state/global":"docs","docs/0.3.4/reference/templates/router-state":"docs","docs/0.2.x/deploying/intro":"docs","docs/0.3.0-0.3.3/testing/fantoccini-basics":"docs","docs/reference/strategies/build-state":"docs","docs/0.3.0-0.3.3/i18n/defining":"docs","docs/0.3.0-0.3.3/strategies/build-paths":"docs","docs/reference/plugins/publishing":"docs","docs/0.3.4/reference/strategies/request-state":"docs","docs/0.2.x/i18n/intro":"docs","docs/reference/define-app":"docs","docs/0.4.x/reference/perseus-app":"docs","docs/reference/ejecting":"docs","docs/0.4.x/reference/pitfalls-and-bugs":"docs","docs/0.3.0-0.3.3/plugins/writing":"docs","docs/advanced/intro":"docs","docs/0.3.4/reference/i18n/translations-managers":"docs","docs/0.3.0-0.3.3/hello-world":"docs","docs/0.4.x/reference/templates/setting-headers":"docs","docs/0.3.4/reference/updating":"docs","docs/reference/i18n/intro":"docs","docs/0.3.4/reference/perseus-app":"docs","docs/0.3.4/reference/testing/intro":"docs","docs/reference/i18n/other-engines":"docs","docs/reference/testing/intro":"docs","docs/0.3.0-0.3.3/i18n/other-engines":"docs","docs/0.4.x/reference/deploying/intro":"docs","docs/0.4.x/reference/deploying/docker":"docs","docs/reference/perseus-app":"docs","docs/0.3.0-0.3.3/deploying/serverless":"docs","docs/0.3.4/reference/ejecting":"docs","docs/0.3.0-0.3.3/testing/checkpoints":"docs","docs/0.3.0-0.3.3/templates/intro":"docs","docs/0.1.x/config_managers":"docs","docs/reference/styling":"docs","docs/0.3.4/what-is-perseus":"docs","docs/0.3.0-0.3.3/plugins/using":"docs","docs/tutorials/hello-world":"docs","docs/0.3.0-0.3.3/i18n/intro":"docs","docs/0.3.4/advanced/intro":"docs","docs/0.4.x/reference/views":"docs","docs/0.3.4/reference/snooping":"docs","docs/0.3.4/reference/state/rx":"docs","docs/0.2.x/testing/intro":"docs","docs/0.3.4/tutorials/hello-world":"docs","docs/0.1.x/building":"docs","docs/0.4.x/reference/plugins/tinker":"docs","docs/0.2.x/i18n/translations-managers":"docs","docs/0.3.0-0.3.3/pitfalls-and-bugs":"docs","docs/0.3.4/reference/state/global":"docs","docs/reference/templates/metadata-modification":"docs","docs/0.4.x/reference/templates/router-state":"docs","docs/0.3.0-0.3.3/deploying/size":"docs","docs/0.3.4/reference/strategies/build-state":"docs","docs":"docs","docs/reference/live-reloading":"docs","docs/0.3.4/reference/plugins/functional":"docs","docs/reference/templates/router-state":"docs","docs/0.4.x/reference/templates/intro":"docs","docs/0.3.0-0.3.3/deploying/serverful":"docs","docs/0.2.x/advanced/routing":"docs","docs/advanced/subsequent-loads":"docs","docs/0.2.x/advanced/arch":"docs","docs/0.4.x/reference/live-reloading":"docs","docs/0.4.x/what-is-perseus":"docs","docs/0.3.0-0.3.3/what-is-perseus":"docs","docs/reference/plugins/functional":"docs","docs/0.4.x/reference/testing/checkpoints":"docs","docs/0.3.4/reference/plugins/using":"docs","docs/0.3.4/advanced/initial-loads":"docs","docs/0.3.4/reference/hydration":"docs","docs/0.2.x/advanced/initial-loads":"docs","docs/0.3.0-0.3.3/views":"docs","docs/0.4.x/reference/stores":"docs","docs/0.1.x/setup":"docs","docs/advanced/initial-loads":"docs","docs/0.4.x/reference/deploying/relative-paths":"docs","docs/0.3.4/tutorials/auth":"docs","docs/0.3.4/reference/engines":"docs","docs/0.4.x/advanced/routing":"docs","docs/0.2.x/templates/metadata-modification":"docs","docs/0.1.x/cli":"docs","docs/0.4.x/reference/engines":"docs","docs/0.4.x/advanced/initial-loads":"docs","docs/0.2.x/intro":"docs","docs/0.3.0-0.3.3/i18n/translations-managers":"docs","docs/0.2.x/views":"docs","docs/reference/strategies/build-paths":"docs","docs/next/core-princles":"docs","docs/0.2.x/ejecting":"docs","docs/0.1.x/intro":"docs","docs/0.2.x/testing/checkpoints":"docs","docs/0.3.0-0.3.3/strategies/request-state":"docs","docs/0.1.x/strategies/incremental":"docs","docs/0.3.0-0.3.3/error-pages":"docs","docs/0.3.4/reference/plugins/control":"docs","docs/0.2.x/hello-world":"docs","docs/0.4.x/reference/index-view":"docs","docs/0.4.x/reference/cli":"docs","docs/0.3.4/reference/templates/metadata-modification":"docs","docs/reference/deploying/relative-paths":"docs","docs/0.3.4/core-principles":"docs","docs/0.3.4/reference/exporting":"docs","docs/next/reference/hydration":"docs","docs/0.3.0-0.3.3/deploying/intro":"docs","docs/advanced/routing":"docs","docs/0.3.4/reference/deploying/docker":"docs","docs/0.4.x/reference/strategies/revalidation":"docs","docs/0.3.4/tutorials/second-app":"docs","docs/0.3.4/advanced/subsequent-loads":"docs","docs/reference/strategies/intro":"docs","docs/reference/i18n/defining":"docs","docs/0.2.x/what-is-perseus":"docs","docs/0.3.0-0.3.3/plugins/control":"docs","docs/reference/state/freezing":"docs","docs/0.3.4/reference/strategies/intro":"docs","docs/0.3.0-0.3.3/plugins/tinker":"docs","docs/reference/testing/fantoccini-basics":"docs","docs/reference/deploying/serverful":"docs","docs/0.4.x/reference/testing/manual":"docs","docs/0.2.x/testing/fantoccini-basics":"docs","docs/0.3.0-0.3.3/plugins/functional":"docs","docs/0.4.x/reference/state/rx":"docs","docs/next/reference/migrating":"docs","docs/0.1.x/strategies/build_paths":"docs","docs/0.3.0-0.3.3/advanced/subsequent-loads":"docs","docs/0.2.x/strategies/incremental":"docs","docs/reference/strategies/amalgamation":"docs","docs/0.4.x/reference/plugins/security":"docs","docs/0.3.0-0.3.3/debugging":"docs","docs/0.2.x/templates/setting-headers":"docs","docs/0.1.x/tutorials/first_app/setup":"docs","docs/0.3.4/reference/stores":"docs","docs/reference/plugins/writing":"docs","docs/0.4.x/reference/static-content":"docs","docs/0.3.0-0.3.3/define-app":"docs","docs/tutorials/auth":"docs","docs/0.3.0-0.3.3/advanced/routing":"docs","comparisons":"comparisons","docs/0.1.x/strategies/build_state":"docs","docs/0.3.4/reference/views":"docs","docs/0.4.x/tutorials/second-app":"docs","docs/next/reference/architecture":"docs","docs/0.4.x/reference/plugins/functional":"docs","docs/0.3.4/intro":"docs","docs/0.3.4/reference/static-content":"docs","docs/0.3.4/reference/debugging":"docs","docs/0.4.x/advanced/intro":"docs","docs/next/reference/i18n":"docs","docs/0.4.x/intro":"docs","docs/reference/snooping":"docs","docs/0.4.x/reference/plugins/using":"docs","docs/reference/templates/intro":"docs","docs/reference/hydration":"docs","docs/next/intro":"docs","docs/reference/deploying/serverless":"docs","docs/next/tutorials/second-app":"docs","docs/0.4.x/tutorials/auth":"docs","docs/0.3.4/advanced/routing":"docs","docs/0.4.x/reference/plugins/control":"docs","docs/reference/i18n/using":"docs","docs/0.3.0-0.3.3/advanced/arch":"docs","docs/0.1.x/arch":"docs","docs/0.4.x/reference/exporting":"docs","docs/0.1.x/routing":"docs","docs/0.3.4/reference/testing/manual":"docs","docs/0.3.0-0.3.3/intro":"docs","docs/0.3.0-0.3.3/testing/manual":"docs","docs/0.4.x/reference/debugging":"docs","docs/0.3.0-0.3.3/strategies/amalgamation":"docs","docs/0.3.0-0.3.3/exporting":"docs","docs/0.3.0-0.3.3/strategies/incremental":"docs","docs/next/getting-started/first-app":"docs","docs/reference/testing/manual":"docs","docs/0.4.x/reference/templates/metadata-modification":"docs","index":"index","docs/0.3.4/reference/state/idb-freezing":"docs","docs/0.3.0-0.3.3/deploying/relative-paths":"docs","docs/0.3.4/advanced/arch":"docs","docs/0.4.x/advanced/arch":"docs","docs/reference/debugging":"docs","docs/0.3.0-0.3.3/advanced/initial-loads":"docs","docs/0.3.4/reference/i18n/using":"docs","docs/reference/deploying/intro":"docs","docs/next/getting-started/installation":"docs","docs/0.3.4/reference/index-view":"docs","docs/reference/state/rx":"docs","docs/0.3.4/reference/pitfalls-and-bugs":"docs","docs/reference/plugins/intro":"docs","docs/reference/state/idb-freezing":"docs","docs/0.2.x/strategies/amalgamation":"docs","docs/0.3.4/reference/deploying/size":"docs","docs/reference/i18n/translations-managers":"docs","docs/reference/views":"docs","docs/intro":"docs","docs/0.3.4/reference/i18n/intro":"docs","docs/0.4.x/reference/plugins/intro":"docs","docs/0.3.0-0.3.3/advanced/define_app":"docs","docs/0.3.4/reference/i18n/defining":"docs","docs/0.1.x/strategies/intro":"docs","docs/0.4.x/reference/plugins/publishing":"docs","docs/0.4.x/reference/hydration":"docs","docs/0.2.x/config-managers":"docs","docs/0.3.0-0.3.3/strategies/revalidation":"docs","docs/reference/server-communication":"docs","docs/0.2.x/advanced/intro":"docs","docs/0.3.4/reference/state/hsr":"docs","docs/reference/deploying/size":"docs","docs/reference/cli":"docs","docs/core-principles":"docs","docs/0.1.x/error_pages":"docs"}';

        import init, { run } from "https://arctic-hen7.github.io/perseus/.perseus/bundle.js";
        async function main() {
            await init("https://arctic-hen7.github.io/perseus/.perseus/bundle.wasm");
            run();
        }
        main();
        

window.__PERSEUS_GLOBAL_STATE = `None`;</script>
            <!--PERSEUS_INTERPOLATED_HEAD_BEGINS-->
            
<title data-hk="1.0">Freezing to IndexedDB | Perseus Docs</title><link href=".perseus/static/styles/markdown.css" data-hk="1.1" rel="stylesheet"/><link data-hk="1.2" href=".perseus/static/styles/docs_links_markdown.css" rel="stylesheet"/><link data-hk="1.3" rel="stylesheet" href=".perseus/static/prism.css"/>
            <script>
window.__PERSEUS_INITIAL_STATE = `{"title":"Freezing to IndexedDB","content":"<h1>Freezing to IndexedDB</h1>\\n<p>One of the most common places to store frozen state is inside the browser, which can be done with Perseus' inbuilt <code>IdbFrozenStateStore</code> system, which uses <a href=\\"https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API\\">IndexedDB</a> to store as many frozen states as you want, allowing you to revert to not just the previous state, but the one before that, the one before that, etc.</p>\\n<p>To use this system, you'll need to enable the <code>idb-freezing</code> feature flag, and then you can use the system as per the below example.</p>\\n<h1>Example</h1>\\n<p>The following code is taken from <a href=\\"https://github.com/arctic-hen7/perseus/tree/main/examples/idb_freezing/src/idb.rs\\">here</a>.</p>\\n<pre><code class=\\"language-rust\\">use perseus::{Html, RenderFnResultWithCause, Template};\\nuse sycamore::prelude::*;\\n\\nuse crate::global_state::*;\\n\\n#[perseus::make_rx(IndexPropsRx)]\\npub struct IndexProps {\\n    username: String,\\n}\\n\\n#[perseus::template_rx]\\npub fn index_page&lt;'a, G: Html&gt;(\\n    cx: Scope&lt;'a&gt;,\\n    state: IndexPropsRx&lt;'a&gt;,\\n    global_state: AppStateRx&lt;'a&gt;,\\n) -&gt; View&lt;G&gt; {\\n    // This is not part of our data model\\n    let freeze_status = create_signal(cx, String::new());\\n    let thaw_status = create_signal(cx, String::new());\\n    // It's faster to get this only once and rely on reactivity\\n    // But it's unused when this runs on the server-side because of the target-gate below\\n    #[allow(unused_variables)]\\n    let render_ctx = perseus::get_render_ctx!(cx);\\n\\n    view! { cx,\\n        // For demonstration, we'll let the user modify the page's state and the global state arbitrarily\\n        p(id = &quot;page_state&quot;) { (format!(&quot;Greetings, {}!&quot;, state.username.get())) }\\n        input(id = &quot;set_page_state&quot;, bind:value = state.username, placeholder = &quot;Username&quot;)\\n        p(id = &quot;global_state&quot;) { (global_state.test.get()) }\\n        input(id = &quot;set_global_state&quot;, bind:value = global_state.test, placeholder = &quot;Global state&quot;)\\n\\n        // When the user visits this and then comes back, they'll still be able to see their username (the previous state will be retrieved from the global state automatically)\\n        a(href = &quot;about&quot;, id = &quot;about-link&quot;) { &quot;About&quot; }\\n        br()\\n\\n        button(id = &quot;freeze_button&quot;, on:click = move |_| {\\n            // The IndexedDB API is asynchronous, so we'll spawn a future\\n            #[cfg(target_arch = &quot;wasm32&quot;)] // The freezing types are only available in the browser\\n            perseus::spawn_local_scoped(cx, async {\\n                use perseus::state::{IdbFrozenStateStore, Freeze, PageThawPrefs, ThawPrefs};\\n                // We do this here (rather than when we get the render context) so that it's updated whenever we press the button\\n                let frozen_state = render_ctx.freeze();\\n                let idb_store = match IdbFrozenStateStore::new().await {\\n                    Ok(idb_store) =&gt; idb_store,\\n                    Err(_) =&gt; {\\n                        freeze_status.set(&quot;Error.&quot;.to_string());\\n                        return;\\n                    }\\n                };\\n                match idb_store.set(&amp;frozen_state).await {\\n                    Ok(_) =&gt; freeze_status.set(&quot;Saved.&quot;.to_string()),\\n                    Err(_) =&gt; freeze_status.set(&quot;Error.&quot;.to_string())\\n                };\\n            })\\n        }) { &quot;Freeze to IndexedDB&quot; }\\n        p { (freeze_status.get()) }\\n\\n        button(id = &quot;thaw_button&quot;, on:click = move |_| {\\n            // The IndexedDB API is asynchronous, so we'll spawn a future\\n            #[cfg(target_arch = &quot;wasm32&quot;)] // The freezing types are only available in the browser\\n            perseus::spawn_local_scoped(cx, async move {\\n                use perseus::state::{IdbFrozenStateStore, Freeze, PageThawPrefs, ThawPrefs};\\n                let idb_store = match IdbFrozenStateStore::new().await {\\n                    Ok(idb_store) =&gt; idb_store,\\n                    Err(_) =&gt; {\\n                        thaw_status.set(&quot;Error.&quot;.to_string());\\n                        return;\\n                    }\\n                };\\n                let frozen_state = match idb_store.get().await {\\n                    Ok(Some(frozen_state)) =&gt; frozen_state,\\n                    Ok(None) =&gt; {\\n                        thaw_status.set(&quot;No state stored.&quot;.to_string());\\n                        return;\\n                    }\\n                    Err(_) =&gt; {\\n                        thaw_status.set(&quot;Error.&quot;.to_string());\\n                        return;\\n                    }\\n                };\\n\\n                // You would probably set your thawing preferences differently\\n                match render_ctx.thaw(&amp;frozen_state, ThawPrefs { page: PageThawPrefs::IncludeAll, global_prefer_frozen: true }) {\\n                    Ok(_) =&gt; thaw_status.set(&quot;Thawed.&quot;.to_string()),\\n                    Err(_) =&gt; thaw_status.set(&quot;Error.&quot;.to_string())\\n                }\\n            })\\n        }) { &quot;Thaw from IndexedDB&quot; }\\n        p { (thaw_status.get()) }\\n    }\\n}\\n\\npub fn get_template&lt;G: Html&gt;() -&gt; Template&lt;G&gt; {\\n    Template::new(&quot;index&quot;)\\n        .build_state_fn(get_build_state)\\n        .template(index_page)\\n}\\n\\n#[perseus::build_state]\\npub async fn get_build_state(\\n    _path: String,\\n    _locale: String,\\n) -&gt; RenderFnResultWithCause&lt;IndexProps&gt; {\\n    Ok(IndexProps {\\n        username: &quot;&quot;.to_string(),\\n    })\\n}\\n\\n</code></pre>\\n<p>This example is very contrived, but it illustrates the fundamentals of freezing and thawing to IndexedDB. You'll need to perform most of this logic in a <code>wasm_bindgen_futures::spawn_local()</code>, a function that spawns a future in the browser, because the IndexedDB API is asynchronous (so that costly DB operations don't block the main UI thread). The first button we have in this example has its <code>on:click</code> handler set to one of these futures, and it then freezes the state, initializes the database (which will either create it or open it if it already exists), and then calls <code>.set()</code> to set the new frozen state (which will remove previously stored frozen states in the background). The rest of the code here is just boilerplate for reporting successes or failures to the user.</p>\\n<p>Notably, the operations you'll perform through <code>IdbFrozenStateStore</code> are all fallible, they can all return an <code>Err</code>. These cases should be handled carefully, because there are a myriad number of causes (filesystem errors in the browser, invalid data, etc.). Perseus tries to shield you from these as much as possible, but you should be wary of potentially extremely strange errors when working with IndexedDB (they should be very rare though). If your app experiences an error, it's often worth retrying the operation once to see if it works the second time. If you're having trouble in local development, you should use your browser's developer tools to delete the <code>perseus</code> database.</p>\\n<p>As for thawing, the process is essentially the same, except in reverse, and it should be noted that the <code>.thaw()</code> method is fallible, while the <code>.freeze()</code> method is not. This is due to the potential issues of accepting a frozen state of unknown origin.</p>\\n<p>One thing that may seem strange here is that we get the render context outside the click handlers. The reason for this is that the render context is composed almost entirely of <code>Signal</code>s and the like, so once you have one instance, it will update. Further, we actually couldn't get the render context in the futures even if we tried, since once we go into the future, we decouple from Sycamore's rendering system, so the context no longer exists as far as it's concerned. We can work around this, but for simplicity it's best to just get the render context at the beginning and use it later.</p>\\n<p>It's also important to understand that we don't freeze straight away, but only when the user presses the button, since the result of <code>.freeze()</code> is an unreactive <code>String</code>, which won't update with changes to our app's state.</p>\\n","sidebar_content":"<h1>Introduction</h1>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/intro\\">Introduction</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/what-is-perseus\\">What is Perseus?</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/core-principles\\">Core Principles</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/tutorials/hello-world\\">Hello World!</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/tutorials/second-app\\">Your Second App</a></li>\\n</ul>\\n<hr />\\n<h1>Reference</h1>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/perseus-app\\"><code>PerseusApp</code></a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/define-app\\"><code>define_app!</code></a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/views\\">Writing Views</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/index-view\\">The Index View</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/debugging\\">Debugging</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/live-reloading\\">Live Reloading</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/templates/intro\\">Templates and Routing</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/templates/metadata-modification\\">Modifying the <code>&lt;head&gt;</code></a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/templates/setting-headers\\">Modifying HTTP Headers</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/templates/router-state\\">Listening to the Router</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/error-pages\\">Error Pages</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/static-content\\">Static Content</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/i18n/intro\\">Internationalization</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/i18n/defining\\">Defining Translations</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/i18n/using\\">Using Translations</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/i18n/translations-managers\\">Translations Managers</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/i18n/other-engines\\">Other Translation Engines</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/intro\\">Rendering Strategies</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/build-state\\">Build State</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/build-paths\\">Build Paths</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/request-state\\">Request State</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/revalidation\\">Revalidation</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/incremental\\">Incremental Generation</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/amalgamation\\">State Amalgamation</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/hydration\\">Hydration</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/state/rx\\">Reactive State</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/state/global\\">Global State</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/state/freezing\\">State Freezing</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/state/idb-freezing\\">Freezing to IndexedDB</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/state/hsr\\">Hot State Reloading (HSR)</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/cli\\">CLI</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/ejecting\\">Ejecting</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/snooping\\">Snooping</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/testing/intro\\">Testing</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/testing/checkpoints\\">Checkpoints</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/testing/fantoccini-basics\\">Fantoccini Basics</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/testing/manual\\">Manual Testing</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/styling\\">Styling</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/server-communication\\">Communicating with a Server</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/stores\\">Stores</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/exporting\\">Static Exporting</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/intro\\">Plugins</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/functional\\">Functional Actions</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/control\\">Control Actions</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/using\\">Using Plugins</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/tinker\\">The <code>tinker</code> Action</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/writing\\">Writing Plugins</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/security\\">Security Considerations</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/publishing\\">Publishing Plugins</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/engines\\">Engines</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/intro\\">Deploying</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/serverful\\">Server Deployment</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/serverless\\">Serverless Deployment</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/size\\">Optimizing Code Size</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/relative-paths\\">Relative Paths</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/docker\\">Docker Deployment</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/updating\\">Migrating from v0.3.x</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/pitfalls-and-bugs\\">Common Pitfalls and Known Bugs</a></li>\\n</ul>\\n<hr />\\n<h1>Advanced</h1>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/intro\\">Under the Hood</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/arch\\">Architecture</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/initial-loads\\">Initial Loads</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/subsequent-loads\\">Subsequent Loads</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/routing\\">Routing</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/route-announcer\\">Route Announcer</a></li>\\n</ul>\\n<hr />\\n<h1>Further Tutorials</h1>\\n<ul>\\n<li><a href=\\"docs/tutorials/auth\\">Authentication</a></li>\\n</ul>\\n","status":"Beta","manifest":{"stable":"0.3.4","outdated":["0.3.0-0.3.3","0.2.x","0.1.x"],"beta":["0.4.x"],"history_map":{"0.3.0-0.3.3":"v0.3.3","0.2.x":"v0.2.3","0.1.x":"v0.1.4","0.3.4":"eccf137032fbe8e6507be9e9317edc16e7576a4f","0.4.x":"HEAD"}},"current_version":"0.4.x"}`;</script>
            </head><body class="bg-white dark:bg-navy"><div><div id="root"><div id="__perseus_content_initial" class="__perseus_content"><header class="shadow-md sm:p-2 w-full bg-white dark:text-white dark:bg-navy mb-20" data-hk="3.0"><div data-hk="3.1" class="flex justify-between"><a data-hk="3.2" href="en-US/" class="justify-self-start self-center m-3 ml-5 text-md sm:text-2xl">Perseus</a><div data-hk="3.3" class="md:hidden m-3 mr-5 tham tham-e-spin tham-w-6 "><div data-hk="3.4" class="tham-box"><div data-hk="3.5" class="dark:bg-white tham-inner"></div></div></div><nav data-hk="3.6" class="hidden md:flex"><ul class="mr-5 flex" data-hk="3.7"><li class="m-3 p-1" data-hk="4.0"><a data-hk="4.1" href="en-US/docs" class="px-2">Docs</a></li><li data-hk="4.2" class="m-3 p-1"><a data-hk="4.3" class="px-2" href="en-US/comparisons">Comparisons</a></li><li class="m-3 p-1" data-hk="4.4"><a class="px-2" href="en-US/plugins" data-hk="4.5">Plugins</a></li></ul></nav></div><nav data-hk="3.8" class="md:hidden w-full text-center justify-center overflow-y-scroll hidden" id="mobile_nav_menu"><div style="max-height: 500px" data-hk="3.9" class="mr-5 overflow-y-scroll"><ul data-hk="3.10"><li data-hk="5.0" class="m-3 p-1"><a data-hk="5.1" href="en-US/docs" class="px-2">Docs</a></li><li data-hk="5.2" class="m-3 p-1"><a data-hk="5.3" href="en-US/comparisons" class="px-2">Comparisons</a></li><li class="m-3 p-1" data-hk="5.4"><a data-hk="5.5" href="en-US/plugins" class="px-2">Plugins</a></li></ul><hr data-hk="3.11"/><div data-hk="3.12" class="text-left p-3"><!--#--><!----><select class="p-2 rounded-md text-white bg-indigo-500" data-hk="6.0"><option value="next" data-hk="6.1">Next (unreleased)</option><!--#--><option value="0.4.x" selected="" data-hk="6.2">v⁨0.4.x⁩ (beta)</option><!--/--><option value="0.3.4" data-hk="6.3">v⁨0.3.4⁩ (stable)</option><!--#--><option value="0.3.0-0.3.3" data-hk="6.4">v⁨0.3.0-0.3.3⁩ (outdated)</option><option value="0.2.x" data-hk="6.5">v⁨0.2.x⁩ (outdated)</option><option value="0.1.x" data-hk="6.6">v⁨0.1.x⁩ (outdated)</option><!--/--></select><!--/--><div class="docs-links-markdown" data-hk="3.13"><h1>Introduction</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/intro">Introduction</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/what-is-perseus">What is Perseus?</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/core-principles">Core Principles</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/tutorials/hello-world">Hello World!</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/tutorials/second-app">Your Second App</a></li>
</ul>
<hr />
<h1>Reference</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/perseus-app"><code>PerseusApp</code></a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/define-app"><code>define_app!</code></a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/views">Writing Views</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/index-view">The Index View</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/debugging">Debugging</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/live-reloading">Live Reloading</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/templates/intro">Templates and Routing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/templates/metadata-modification">Modifying the <code>&lt;head&gt;</code></a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/templates/setting-headers">Modifying HTTP Headers</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/templates/router-state">Listening to the Router</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/error-pages">Error Pages</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/static-content">Static Content</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/i18n/intro">Internationalization</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/i18n/defining">Defining Translations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/i18n/using">Using Translations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/i18n/translations-managers">Translations Managers</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/i18n/other-engines">Other Translation Engines</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/intro">Rendering Strategies</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/build-state">Build State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/build-paths">Build Paths</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/request-state">Request State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/revalidation">Revalidation</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/incremental">Incremental Generation</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/amalgamation">State Amalgamation</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/hydration">Hydration</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/state/rx">Reactive State</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/state/global">Global State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/state/freezing">State Freezing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/state/idb-freezing">Freezing to IndexedDB</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/state/hsr">Hot State Reloading (HSR)</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/cli">CLI</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/ejecting">Ejecting</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/snooping">Snooping</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/testing/intro">Testing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/testing/checkpoints">Checkpoints</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/testing/fantoccini-basics">Fantoccini Basics</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/testing/manual">Manual Testing</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/styling">Styling</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/server-communication">Communicating with a Server</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/stores">Stores</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/exporting">Static Exporting</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/intro">Plugins</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/functional">Functional Actions</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/control">Control Actions</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/using">Using Plugins</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/tinker">The <code>tinker</code> Action</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/writing">Writing Plugins</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/security">Security Considerations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/publishing">Publishing Plugins</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/engines">Engines</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/intro">Deploying</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/serverful">Server Deployment</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/serverless">Serverless Deployment</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/size">Optimizing Code Size</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/relative-paths">Relative Paths</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/docker">Docker Deployment</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/updating">Migrating from v0.3.x</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/pitfalls-and-bugs">Common Pitfalls and Known Bugs</a></li>
</ul>
<hr />
<h1>Advanced</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/intro">Under the Hood</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/arch">Architecture</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/initial-loads">Initial Loads</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/subsequent-loads">Subsequent Loads</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/routing">Routing</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/route-announcer">Route Announcer</a></li>
</ul>
<hr />
<h1>Further Tutorials</h1>
<ul>
<li><a href="docs/tutorials/auth">Authentication</a></li>
</ul>
</div></div></div></nav></header><div class="mt-14 xs:mt-16 sm:mt-20 lg:mt-25 overflow-y-auto flex" data-hk="3.14"><div data-hk="3.15" class="flex w-full"><div data-hk="3.16" class="h-full hidden md:block max-w-xs w-full border-r"><div class="mr-5" data-hk="3.17"><div data-hk="3.18" class="text-left text-black dark:text-white p-3"><aside data-hk="3.19"><!--#--><!----><select data-hk="7.0" class="p-2 rounded-md text-white bg-indigo-500"><option data-hk="7.1" value="next">Next (unreleased)</option><!--#--><option data-hk="7.2" selected="" value="0.4.x">v⁨0.4.x⁩ (beta)</option><!--/--><option data-hk="7.3" value="0.3.4">v⁨0.3.4⁩ (stable)</option><!--#--><option data-hk="7.4" value="0.3.0-0.3.3">v⁨0.3.0-0.3.3⁩ (outdated)</option><option data-hk="7.5" value="0.2.x">v⁨0.2.x⁩ (outdated)</option><option data-hk="7.6" value="0.1.x">v⁨0.1.x⁩ (outdated)</option><!--/--></select><!--/--><div data-hk="3.20" class="docs-links-markdown"><h1>Introduction</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/intro">Introduction</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/what-is-perseus">What is Perseus?</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/core-principles">Core Principles</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/tutorials/hello-world">Hello World!</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/tutorials/second-app">Your Second App</a></li>
</ul>
<hr />
<h1>Reference</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/perseus-app"><code>PerseusApp</code></a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/define-app"><code>define_app!</code></a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/views">Writing Views</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/index-view">The Index View</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/debugging">Debugging</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/live-reloading">Live Reloading</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/templates/intro">Templates and Routing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/templates/metadata-modification">Modifying the <code>&lt;head&gt;</code></a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/templates/setting-headers">Modifying HTTP Headers</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/templates/router-state">Listening to the Router</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/error-pages">Error Pages</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/static-content">Static Content</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/i18n/intro">Internationalization</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/i18n/defining">Defining Translations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/i18n/using">Using Translations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/i18n/translations-managers">Translations Managers</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/i18n/other-engines">Other Translation Engines</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/intro">Rendering Strategies</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/build-state">Build State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/build-paths">Build Paths</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/request-state">Request State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/revalidation">Revalidation</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/incremental">Incremental Generation</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/strategies/amalgamation">State Amalgamation</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/hydration">Hydration</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/state/rx">Reactive State</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/state/global">Global State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/state/freezing">State Freezing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/state/idb-freezing">Freezing to IndexedDB</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/state/hsr">Hot State Reloading (HSR)</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/cli">CLI</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/ejecting">Ejecting</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/snooping">Snooping</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/testing/intro">Testing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/testing/checkpoints">Checkpoints</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/testing/fantoccini-basics">Fantoccini Basics</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/testing/manual">Manual Testing</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/styling">Styling</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/server-communication">Communicating with a Server</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/stores">Stores</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/exporting">Static Exporting</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/intro">Plugins</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/functional">Functional Actions</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/control">Control Actions</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/using">Using Plugins</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/tinker">The <code>tinker</code> Action</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/writing">Writing Plugins</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/security">Security Considerations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/plugins/publishing">Publishing Plugins</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/engines">Engines</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/intro">Deploying</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/serverful">Server Deployment</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/serverless">Serverless Deployment</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/size">Optimizing Code Size</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/relative-paths">Relative Paths</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/deploying/docker">Docker Deployment</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/updating">Migrating from v0.3.x</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/reference/pitfalls-and-bugs">Common Pitfalls and Known Bugs</a></li>
</ul>
<hr />
<h1>Advanced</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/intro">Under the Hood</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/arch">Architecture</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/initial-loads">Initial Loads</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/subsequent-loads">Subsequent Loads</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/routing">Routing</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.4.x/advanced/route-announcer">Route Announcer</a></li>
</ul>
<hr />
<h1>Further Tutorials</h1>
<ul>
<li><a href="docs/tutorials/auth">Authentication</a></li>
</ul>
</div></aside></div></div></div><div data-hk="3.21" class="h-full flex w-full"><div data-hk="3.22" class="px-3 w-full sm:mr-auto sm:ml-auto sm:max-w-prose lg:max-w-3xl xl:max-w-4xl 2xl:max-w-5xl"><!--#--><div data-hk="3.23" class="ring-4 ring-yellow-300 p-4 rounded-lg mt-1"><div class="flex flex-col 2xs:flex-row dark:text-white" data-hk="3.24"><span data-hk="3.25" class="self-center mr-2" style="fill: #fcd34d;"><svg xmlns="http://www.w3.org/2000/svg" height="auto" viewBox="0 0 24 24" width="2.25rem" fill="\#000000"><path d="M12 5.99L19.53 19H4.47L12 5.99M2.74 18c-.77 1.33.19 3 1.73 3h15.06c1.54 0 2.5-1.67 1.73-3L13.73 4.99c-.77-1.33-2.69-1.33-3.46 0L2.74 18zM11 11v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zm0 5h2v2h-2z"/></svg></span><p data-hk="3.26">This version of the documentation is for a version that has only been released in beta, and is not yet stable. Features documented here may not be present in the latest stable version, and they're subject to rapid and drastic change. You can see the latest stable version of the docs <a href="en-US/docs/0.3.x/intro" class="underline">here</a>.</p></div></div><!--/--><main data-hk="3.27" class="text-black dark:text-white"><div data-hk="2.0" class="markdown"><h1>Freezing to IndexedDB</h1>
<p>One of the most common places to store frozen state is inside the browser, which can be done with Perseus' inbuilt <code>IdbFrozenStateStore</code> system, which uses <a href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API">IndexedDB</a> to store as many frozen states as you want, allowing you to revert to not just the previous state, but the one before that, the one before that, etc.</p>
<p>To use this system, you'll need to enable the <code>idb-freezing</code> feature flag, and then you can use the system as per the below example.</p>
<h1>Example</h1>
<p>The following code is taken from <a href="https://github.com/arctic-hen7/perseus/tree/main/examples/idb_freezing/src/idb.rs">here</a>.</p>
<pre><code class="language-rust">use perseus::{Html, RenderFnResultWithCause, Template};
use sycamore::prelude::*;

use crate::global_state::*;

#[perseus::make_rx(IndexPropsRx)]
pub struct IndexProps {
    username: String,
}

#[perseus::template_rx]
pub fn index_page&lt;'a, G: Html&gt;(
    cx: Scope&lt;'a&gt;,
    state: IndexPropsRx&lt;'a&gt;,
    global_state: AppStateRx&lt;'a&gt;,
) -&gt; View&lt;G&gt; {
    // This is not part of our data model
    let freeze_status = create_signal(cx, String::new());
    let thaw_status = create_signal(cx, String::new());
    // It's faster to get this only once and rely on reactivity
    // But it's unused when this runs on the server-side because of the target-gate below
    #[allow(unused_variables)]
    let render_ctx = perseus::get_render_ctx!(cx);

    view! { cx,
        // For demonstration, we'll let the user modify the page's state and the global state arbitrarily
        p(id = &quot;page_state&quot;) { (format!(&quot;Greetings, {}!&quot;, state.username.get())) }
        input(id = &quot;set_page_state&quot;, bind:value = state.username, placeholder = &quot;Username&quot;)
        p(id = &quot;global_state&quot;) { (global_state.test.get()) }
        input(id = &quot;set_global_state&quot;, bind:value = global_state.test, placeholder = &quot;Global state&quot;)

        // When the user visits this and then comes back, they'll still be able to see their username (the previous state will be retrieved from the global state automatically)
        a(href = &quot;about&quot;, id = &quot;about-link&quot;) { &quot;About&quot; }
        br()

        button(id = &quot;freeze_button&quot;, on:click = move |_| {
            // The IndexedDB API is asynchronous, so we'll spawn a future
            #[cfg(target_arch = &quot;wasm32&quot;)] // The freezing types are only available in the browser
            perseus::spawn_local_scoped(cx, async {
                use perseus::state::{IdbFrozenStateStore, Freeze, PageThawPrefs, ThawPrefs};
                // We do this here (rather than when we get the render context) so that it's updated whenever we press the button
                let frozen_state = render_ctx.freeze();
                let idb_store = match IdbFrozenStateStore::new().await {
                    Ok(idb_store) =&gt; idb_store,
                    Err(_) =&gt; {
                        freeze_status.set(&quot;Error.&quot;.to_string());
                        return;
                    }
                };
                match idb_store.set(&amp;frozen_state).await {
                    Ok(_) =&gt; freeze_status.set(&quot;Saved.&quot;.to_string()),
                    Err(_) =&gt; freeze_status.set(&quot;Error.&quot;.to_string())
                };
            })
        }) { &quot;Freeze to IndexedDB&quot; }
        p { (freeze_status.get()) }

        button(id = &quot;thaw_button&quot;, on:click = move |_| {
            // The IndexedDB API is asynchronous, so we'll spawn a future
            #[cfg(target_arch = &quot;wasm32&quot;)] // The freezing types are only available in the browser
            perseus::spawn_local_scoped(cx, async move {
                use perseus::state::{IdbFrozenStateStore, Freeze, PageThawPrefs, ThawPrefs};
                let idb_store = match IdbFrozenStateStore::new().await {
                    Ok(idb_store) =&gt; idb_store,
                    Err(_) =&gt; {
                        thaw_status.set(&quot;Error.&quot;.to_string());
                        return;
                    }
                };
                let frozen_state = match idb_store.get().await {
                    Ok(Some(frozen_state)) =&gt; frozen_state,
                    Ok(None) =&gt; {
                        thaw_status.set(&quot;No state stored.&quot;.to_string());
                        return;
                    }
                    Err(_) =&gt; {
                        thaw_status.set(&quot;Error.&quot;.to_string());
                        return;
                    }
                };

                // You would probably set your thawing preferences differently
                match render_ctx.thaw(&amp;frozen_state, ThawPrefs { page: PageThawPrefs::IncludeAll, global_prefer_frozen: true }) {
                    Ok(_) =&gt; thaw_status.set(&quot;Thawed.&quot;.to_string()),
                    Err(_) =&gt; thaw_status.set(&quot;Error.&quot;.to_string())
                }
            })
        }) { &quot;Thaw from IndexedDB&quot; }
        p { (thaw_status.get()) }
    }
}

pub fn get_template&lt;G: Html&gt;() -&gt; Template&lt;G&gt; {
    Template::new(&quot;index&quot;)
        .build_state_fn(get_build_state)
        .template(index_page)
}

#[perseus::build_state]
pub async fn get_build_state(
    _path: String,
    _locale: String,
) -&gt; RenderFnResultWithCause&lt;IndexProps&gt; {
    Ok(IndexProps {
        username: &quot;&quot;.to_string(),
    })
}

</code></pre>
<p>This example is very contrived, but it illustrates the fundamentals of freezing and thawing to IndexedDB. You'll need to perform most of this logic in a <code>wasm_bindgen_futures::spawn_local()</code>, a function that spawns a future in the browser, because the IndexedDB API is asynchronous (so that costly DB operations don't block the main UI thread). The first button we have in this example has its <code>on:click</code> handler set to one of these futures, and it then freezes the state, initializes the database (which will either create it or open it if it already exists), and then calls <code>.set()</code> to set the new frozen state (which will remove previously stored frozen states in the background). The rest of the code here is just boilerplate for reporting successes or failures to the user.</p>
<p>Notably, the operations you'll perform through <code>IdbFrozenStateStore</code> are all fallible, they can all return an <code>Err</code>. These cases should be handled carefully, because there are a myriad number of causes (filesystem errors in the browser, invalid data, etc.). Perseus tries to shield you from these as much as possible, but you should be wary of potentially extremely strange errors when working with IndexedDB (they should be very rare though). If your app experiences an error, it's often worth retrying the operation once to see if it works the second time. If you're having trouble in local development, you should use your browser's developer tools to delete the <code>perseus</code> database.</p>
<p>As for thawing, the process is essentially the same, except in reverse, and it should be noted that the <code>.thaw()</code> method is fallible, while the <code>.freeze()</code> method is not. This is due to the potential issues of accepting a frozen state of unknown origin.</p>
<p>One thing that may seem strange here is that we get the render context outside the click handlers. The reason for this is that the render context is composed almost entirely of <code>Signal</code>s and the like, so once you have one instance, it will update. Further, we actually couldn't get the render context in the futures even if we tried, since once we go into the future, we decouple from Sycamore's rendering system, so the context no longer exists as far as it's concerned. We can work around this, but for simplicity it's best to just get the render context at the beginning and use it later.</p>
<p>It's also important to understand that we don't freeze straight away, but only when the user presses the button, since the result of <code>.freeze()</code> is an unreactive <code>String</code>, which won't update with changes to our app's state.</p>
</div></main></div></div></div></div><footer data-hk="3.28" class="w-full flex justify-center py-5 bg-gray-100 dark:bg-navy-deep"><p class="dark:text-white mx-5 text-center" data-hk="3.29"><span data-hk="3.30">© <a href="https://github.com/arctic-hen7" class="underline">arctic-hen7</a> ⁨2021⁩, see license <a href="https://github.com/arctic-hen7/perseus/blob/main/LICENSE" class="underline">here</a>.</span></p></footer><script data-hk="2.1" defer="" src=".perseus/static/prism.js"></script><script data-hk="2.2">window.Prism.highlightAll();</script></div></div></div></body></html>